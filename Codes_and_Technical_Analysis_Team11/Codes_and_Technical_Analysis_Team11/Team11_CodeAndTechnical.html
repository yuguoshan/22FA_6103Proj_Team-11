<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="TEAM 11: Anjali Mudgal , Guoshan Yu and Medhasweta Sen">
<meta name="dcterms.date" content="2022-12-20">

<title>AN ANALYSIS OF PORTUGUESE BANK MARKETING DATA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Team11_CodeAndTechnical_files/libs/clipboard/clipboard.min.js"></script>
<script src="Team11_CodeAndTechnical_files/libs/quarto-html/quarto.js"></script>
<script src="Team11_CodeAndTechnical_files/libs/quarto-html/popper.min.js"></script>
<script src="Team11_CodeAndTechnical_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Team11_CodeAndTechnical_files/libs/quarto-html/anchor.min.js"></script>
<link href="Team11_CodeAndTechnical_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Team11_CodeAndTechnical_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Team11_CodeAndTechnical_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Team11_CodeAndTechnical_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Team11_CodeAndTechnical_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">1</span>  INTRODUCTION</a>
  <ul class="collapse">
  <li><a href="#the-data-set" id="toc-the-data-set" class="nav-link" data-scroll-target="#the-data-set"><span class="toc-section-number">1.1</span>  The Data Set</a></li>
  <li><a href="#the-smart-questions" id="toc-the-smart-questions" class="nav-link" data-scroll-target="#the-smart-questions"><span class="toc-section-number">1.2</span>  The SMART Questions</a></li>
  <li><a href="#importing-the-libraries" id="toc-importing-the-libraries" class="nav-link" data-scroll-target="#importing-the-libraries"><span class="toc-section-number">1.3</span>  Importing the libraries</a></li>
  <li><a href="#importing-the-dataset" id="toc-importing-the-dataset" class="nav-link" data-scroll-target="#importing-the-dataset"><span class="toc-section-number">1.4</span>  Importing the dataset</a></li>
  <li><a href="#basic-information-about-the-data" id="toc-basic-information-about-the-data" class="nav-link" data-scroll-target="#basic-information-about-the-data"><span class="toc-section-number">1.5</span>  Basic Information about the data</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda"><span class="toc-section-number">2</span>  Exploratory Data Analysis (EDA)</a>
  <ul class="collapse">
  <li><a href="#analysing-the-variables" id="toc-analysing-the-variables" class="nav-link" data-scroll-target="#analysing-the-variables"><span class="toc-section-number">2.1</span>  Analysing the variables</a>
  <ul class="collapse">
  <li><a href="#job-description" id="toc-job-description" class="nav-link" data-scroll-target="#job-description"><span class="toc-section-number">2.1.1</span>  Job Description</a></li>
  <li><a href="#marital" id="toc-marital" class="nav-link" data-scroll-target="#marital"><span class="toc-section-number">2.1.2</span>  Marital</a></li>
  <li><a href="#loan" id="toc-loan" class="nav-link" data-scroll-target="#loan"><span class="toc-section-number">2.1.3</span>  Loan</a></li>
  <li><a href="#contact" id="toc-contact" class="nav-link" data-scroll-target="#contact"><span class="toc-section-number">2.1.4</span>  Contact</a></li>
  <li><a href="#term-deposit" id="toc-term-deposit" class="nav-link" data-scroll-target="#term-deposit"><span class="toc-section-number">2.1.5</span>  Term Deposit</a></li>
  </ul></li>
  <li><a href="#age-duration-and-balance" id="toc-age-duration-and-balance" class="nav-link" data-scroll-target="#age-duration-and-balance"><span class="toc-section-number">2.2</span>  Age, duration and balance</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="toc-section-number">3</span>  Summary</a>
  <ul class="collapse">
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning"><span class="toc-section-number">3.1</span>  Data Cleaning</a></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization"><span class="toc-section-number">3.2</span>  Data Visualization</a></li>
  </ul></li>
  <li><a href="#data-cleaning-1" id="toc-data-cleaning-1" class="nav-link" data-scroll-target="#data-cleaning-1"><span class="toc-section-number">4</span>  Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#dropping-the-column" id="toc-dropping-the-column" class="nav-link" data-scroll-target="#dropping-the-column"><span class="toc-section-number">4.1</span>  Dropping the column</a></li>
  <li><a href="#dropping-the-rows" id="toc-dropping-the-rows" class="nav-link" data-scroll-target="#dropping-the-rows"><span class="toc-section-number">4.2</span>  Dropping the rows</a>
  <ul class="collapse">
  <li><a href="#dropping-the-rows-where-values-are-3sd-away" id="toc-dropping-the-rows-where-values-are-3sd-away" class="nav-link" data-scroll-target="#dropping-the-rows-where-values-are-3sd-away"><span class="toc-section-number">4.2.1</span>  Dropping the rows where values are 3SD away</a></li>
  <li><a href="#dropping-rows-where-the-duration-of-calls-is-less-than-5sec-since-that-is-irrelevant" id="toc-dropping-rows-where-the-duration-of-calls-is-less-than-5sec-since-that-is-irrelevant" class="nav-link" data-scroll-target="#dropping-rows-where-the-duration-of-calls-is-less-than-5sec-since-that-is-irrelevant"><span class="toc-section-number">4.2.2</span>  Dropping rows where the duration of calls is less than 5sec since that is irrelevant</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-visualization-1" id="toc-data-visualization-1" class="nav-link" data-scroll-target="#data-visualization-1"><span class="toc-section-number">5</span>  Data Visualization</a>
  <ul class="collapse">
  <li><a href="#contact-versus-subscription-month-wise" id="toc-contact-versus-subscription-month-wise" class="nav-link" data-scroll-target="#contact-versus-subscription-month-wise"><span class="toc-section-number">5.0.1</span>  Contact versus Subscription month wise</a></li>
  <li><a href="#number-of-calls-versus-duration-and-affect-on-subscription" id="toc-number-of-calls-versus-duration-and-affect-on-subscription" class="nav-link" data-scroll-target="#number-of-calls-versus-duration-and-affect-on-subscription"><span class="toc-section-number">5.0.2</span>  Number of calls versus Duration and affect on subscription</a></li>
  <li><a href="#smart-question" id="toc-smart-question" class="nav-link" data-scroll-target="#smart-question"><span class="toc-section-number">5.0.3</span>  Smart Question</a></li>
  <li><a href="#month-wise-subscription" id="toc-month-wise-subscription" class="nav-link" data-scroll-target="#month-wise-subscription"><span class="toc-section-number">5.0.4</span>  Month wise subscription</a></li>
  <li><a href="#social-and-economic-factors-in-month" id="toc-social-and-economic-factors-in-month" class="nav-link" data-scroll-target="#social-and-economic-factors-in-month"><span class="toc-section-number">5.0.5</span>  Social and economic Factors in month</a></li>
  </ul></li>
  <li><a href="#checking-the-financially-stable-population" id="toc-checking-the-financially-stable-population" class="nav-link" data-scroll-target="#checking-the-financially-stable-population"><span class="toc-section-number">6</span>  Checking the Financially stable population</a>
  <ul class="collapse">
  <li><a href="#job" id="toc-job" class="nav-link" data-scroll-target="#job"><span class="toc-section-number">6.1</span>  Job</a></li>
  <li><a href="#balance" id="toc-balance" class="nav-link" data-scroll-target="#balance"><span class="toc-section-number">6.2</span>  Balance</a></li>
  <li><a href="#loan-1" id="toc-loan-1" class="nav-link" data-scroll-target="#loan-1"><span class="toc-section-number">6.3</span>  Loan</a></li>
  </ul></li>
  <li><a href="#getting-data-ready-for-modelling" id="toc-getting-data-ready-for-modelling" class="nav-link" data-scroll-target="#getting-data-ready-for-modelling"><span class="toc-section-number">7</span>  Getting Data Ready for Modelling</a>
  <ul class="collapse">
  <li><a href="#encoding" id="toc-encoding" class="nav-link" data-scroll-target="#encoding"><span class="toc-section-number">7.1</span>  Encoding</a>
  <ul class="collapse">
  <li><a href="#dropping-the-unecessary-varibles-for-modelling" id="toc-dropping-the-unecessary-varibles-for-modelling" class="nav-link" data-scroll-target="#dropping-the-unecessary-varibles-for-modelling"><span class="toc-section-number">7.1.1</span>  Dropping the unecessary varibles for modelling</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#splitting-our-dataset" id="toc-splitting-our-dataset" class="nav-link" data-scroll-target="#splitting-our-dataset"><span class="toc-section-number">8</span>  Splitting our Dataset</a></li>
  <li><a href="#balancing-our-dataset" id="toc-balancing-our-dataset" class="nav-link" data-scroll-target="#balancing-our-dataset"><span class="toc-section-number">9</span>  Balancing Our Dataset</a></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression"><span class="toc-section-number">10</span>  Logistic Regression</a></li>
  <li><a href="#balanced-dataset" id="toc-balanced-dataset" class="nav-link" data-scroll-target="#balanced-dataset"><span class="toc-section-number">11</span>  Balanced Dataset</a>
  <ul class="collapse">
  <li><a href="#deciding-cut-off-value-for-logistic-regression---unbalance" id="toc-deciding-cut-off-value-for-logistic-regression---unbalance" class="nav-link" data-scroll-target="#deciding-cut-off-value-for-logistic-regression---unbalance"><span class="toc-section-number">11.0.1</span>  Deciding cut off value for logistic regression - Unbalance</a></li>
  <li><a href="#smart-question-5-the-optimal-cut-off-value-for-classification-of-our-imbalance-dataset." id="toc-smart-question-5-the-optimal-cut-off-value-for-classification-of-our-imbalance-dataset." class="nav-link" data-scroll-target="#smart-question-5-the-optimal-cut-off-value-for-classification-of-our-imbalance-dataset."><span class="toc-section-number">11.0.2</span>  Smart Question 5: The optimal cut off value for classification of our imbalance dataset.</a></li>
  <li><a href="#smart-question-2-since-the-dataset-is-imbalanced-will-down-samplingup-sampling-or-other-techniques-improve-upon-the-accuracy-of-models." id="toc-smart-question-2-since-the-dataset-is-imbalanced-will-down-samplingup-sampling-or-other-techniques-improve-upon-the-accuracy-of-models." class="nav-link" data-scroll-target="#smart-question-2-since-the-dataset-is-imbalanced-will-down-samplingup-sampling-or-other-techniques-improve-upon-the-accuracy-of-models."><span class="toc-section-number">11.0.3</span>  SMART Question 2: Since the dataset is imbalanced, will down sampling/up sampling or other techniques improve upon the accuracy of models.</a></li>
  </ul></li>
  <li><a href="#decision-tree" id="toc-decision-tree" class="nav-link" data-scroll-target="#decision-tree"><span class="toc-section-number">12</span>  Decision Tree</a>
  <ul class="collapse">
  <li><a href="#feature-selection" id="toc-feature-selection" class="nav-link" data-scroll-target="#feature-selection"><span class="toc-section-number">12.1</span>  Feature Selection</a></li>
  <li><a href="#hyperparameter-tuning" id="toc-hyperparameter-tuning" class="nav-link" data-scroll-target="#hyperparameter-tuning"><span class="toc-section-number">12.2</span>  Hyperparameter tuning</a></li>
  </ul></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest"><span class="toc-section-number">13</span>  Random Forest</a>
  <ul class="collapse">
  <li><a href="#feature-selection-1" id="toc-feature-selection-1" class="nav-link" data-scroll-target="#feature-selection-1"><span class="toc-section-number">13.1</span>  Feature Selection</a></li>
  <li><a href="#hyperparameter-tuning-1" id="toc-hyperparameter-tuning-1" class="nav-link" data-scroll-target="#hyperparameter-tuning-1"><span class="toc-section-number">13.2</span>  Hyperparameter Tuning</a></li>
  </ul></li>
  <li><a href="#linear-svc" id="toc-linear-svc" class="nav-link" data-scroll-target="#linear-svc"><span class="toc-section-number">14</span>  Linear SVC</a></li>
  <li><a href="#svc" id="toc-svc" class="nav-link" data-scroll-target="#svc"><span class="toc-section-number">15</span>  SVC</a></li>
  <li><a href="#naive-bayes" id="toc-naive-bayes" class="nav-link" data-scroll-target="#naive-bayes"><span class="toc-section-number">16</span>  Naive Bayes</a>
  <ul class="collapse">
  <li><a href="#for-balanced" id="toc-for-balanced" class="nav-link" data-scroll-target="#for-balanced"><span class="toc-section-number">16.1</span>  For balanced</a></li>
  </ul></li>
  <li><a href="#knn" id="toc-knn" class="nav-link" data-scroll-target="#knn"><span class="toc-section-number">17</span>  KNN</a></li>
  <li><a href="#roc--auc-curve" id="toc-roc--auc-curve" class="nav-link" data-scroll-target="#roc--auc-curve"><span class="toc-section-number">18</span>  ROC -AUC Curve</a></li>
  <li><a href="#precision-recall-curve" id="toc-precision-recall-curve" class="nav-link" data-scroll-target="#precision-recall-curve"><span class="toc-section-number">19</span>  Precision Recall Curve</a></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1"><span class="toc-section-number">20</span>  Summary</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">AN ANALYSIS OF PORTUGUESE BANK MARKETING DATA</h1>
<p class="subtitle lead">The George Washington University (DATS 6103: An Introduction to Data Mining)</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>TEAM 11: Anjali Mudgal , Guoshan Yu and Medhasweta Sen </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 20, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> INTRODUCTION</h1>
<p>Bank marketing is the practice of attracting and acquiring new customers through traditional media and digital media strategies. The use of these media strategies helps determine what kind of customer is attracted to a certain institutions. This also includes different banking institutions purposefully using different strategies to attract the type of customer they want to do business with.</p>
<p>As a discipline, marketing has evolved over the past few decades to become what it is today. Earlier, marketing strategies were primarily a means of spreading brand awareness. Today, marketing has been reinvented to fit a much bigger role. Creating both value and revenue to the institution. It is a big step up from its previous communication role, no doubt. One that was necessitated by the evolution of three factors: the consumer, the technology, and data analytics.</p>
<p>Marketing has evolved from a communication role to a revenue generating role. The consumer has evolved from being a passive recipient of marketing messages to an active participant in the marketing process. Technology has evolved from being a means of communication to a means of data collection and analysis. Data analytics has evolved from being a means of understanding the consumer to a means of understanding the consumer and the institution.</p>
<p>Bank marketing strategy is increasingly focused on digital channels, including social media, video, search and connected TV. As bank and credit union marketers strive to promote brand awareness, they need a new way to assess channel ROI and more accurate data to enable personalized offers. Add to that the growing importance of purpose-driven marketing.</p>
<p>The relentless pace of digitization is disrupting not only the established order in banking, but bank marketing strategies. Marketers at both traditional institutions and digital disruptors are feeling the pressure.</p>
<p>Just as bank marketers begin to master one channel, consumers move to another. Many now toggle between devices on a seemingly infinite number of platforms, making it harder than ever for marketers to pin down the right consumers at the right time in the right place.</p>
<p><img src="expected-marketing-budget-changes-by-channel.png" class="img-fluid"></p>
<section id="the-data-set" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="the-data-set"><span class="header-section-number">1.1</span> The Data Set</h2>
<p>The data set used in this analysis is from a Portuguese bank. The data set contains 41,188 observations and 21 variables. The variables include the following:</p>
<ol type="1">
<li><ul>
<li>age (numeric)</li>
</ul></li>
<li><ul>
<li>job : type of job (categorical: ‘admin.’,‘blue-collar’,‘entrepreneur’,‘housemaid’,‘management’,‘retired’,‘self-employed’,‘services’,‘student’,‘technician’,‘unemployed’,‘unknown’)</li>
</ul></li>
<li><ul>
<li>marital : marital status (categorical: ‘divorced’,‘married’,‘single’,‘unknown’; note: ‘divorced’ means divorced or widowed)</li>
</ul></li>
<li><ul>
<li>education (categorical: ‘basic.4y’,‘basic.6y’,‘basic.9y’,‘high.school’,‘illiterate’,‘professional.course’,‘university.degree’,‘unknown’)</li>
</ul></li>
<li><ul>
<li>default: has credit in default? (categorical: ‘no’,‘yes’,‘unknown’)</li>
</ul></li>
<li><ul>
<li>housing: has housing loan? (categorical: ‘no’,‘yes’,‘unknown’)</li>
</ul></li>
<li><ul>
<li>loan: has personal loan? (categorical: ‘no’,‘yes’,‘unknown’)</li>
</ul></li>
<li><ul>
<li>contact: contact communication type (categorical: ‘cellular’,‘telephone’)</li>
</ul></li>
<li><ul>
<li>month: last contact month of year (categorical: ‘jan’, ‘feb’, ‘mar’, …, ‘nov’, ‘dec’)</li>
</ul></li>
<li><ul>
<li>day_of_week: last contact day of the week (categorical: ‘mon’,‘tue’,‘wed’,‘thu’,‘fri’)</li>
</ul></li>
<li><ul>
<li>duration: last contact duration, in seconds (numeric). Important note: this attribute highly affects the output target (e.g., if duration=0 then y=‘no’). Yet, the duration is not known before a call is performed. Also, after the end of the call y is obviously known. Thus, this input should only be included for benchmark purposes and should be discarded if the intention is to have a realistic predictive model.</li>
</ul></li>
<li><ul>
<li>campaign: number of contacts performed during this campaign and for this client (numeric, includes last contact)</li>
</ul></li>
<li><ul>
<li>pdays: number of days that passed by after the client was last contacted from a previous campaign (numeric; 999 means client was not previously contacted)</li>
</ul></li>
<li><ul>
<li>previous: number of contacts performed before this campaign and for this client (numeric)</li>
</ul></li>
<li><ul>
<li>poutcome: outcome of the previous marketing campaign (categorical: ‘failure’,‘nonexistent’,‘success’)</li>
</ul></li>
<li><ul>
<li>emp.var.rate: employment variation rate - quarterly indicator (numeric)</li>
</ul></li>
<li><ul>
<li>cons.price.idx: consumer price index - monthly indicator (numeric)</li>
</ul></li>
<li><ul>
<li>cons.conf.idx: consumer confidence index - monthly indicator (numeric)</li>
</ul></li>
<li><ul>
<li>euribor3m: euribor 3 month rate - daily indicator (numeric)</li>
</ul></li>
<li><ul>
<li>nr.employed: number of employees - quarterly indicator (numeric)</li>
</ul></li>
<li><ul>
<li>balance - average yearly balance, in euros (numeric)</li>
</ul></li>
<li><ul>
<li>y - has the client subscribed a term deposit? (binary: ‘yes’,‘no’)</li>
</ul></li>
</ol>
</section>
<section id="the-smart-questions" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="the-smart-questions"><span class="header-section-number">1.2</span> The SMART Questions</h2>
<p><img src="maxresdefault.jpg" class="img-fluid"> The SMART questions are as follows:</p>
<p>1.Relationship between subscribing the term deposit and how much the customer is contacted (last contact, Campaign, Pdays, Previous Number of contacts) 2.Since the dataset is imbalanced, will down sampling/up sampling or other techniques improve upon the accuracy of models. 3.Marital status, age, job, and loan to find out the financially stable population?Will that affect the outcome? 4.Effect of dimensionality reduction on accuracy of the model. 5.The optimal cut off value for classification of our imbalance dataset. 6.Modeling to estimate the potential population who would subscribe to termdeposit. 7. How are the likelihood of subscriptions affected by social and economic factors?</p>
<p>As per the comments, 2 and 6 are more of analysis than comments so they would be covered in our analysis.</p>
<p>Throughout the paper we would try to answer the questions</p>
</section>
<section id="importing-the-libraries" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="importing-the-libraries"><span class="header-section-number">1.3</span> Importing the libraries</h2>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> zscore</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.api <span class="im">as</span> sms</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.multicomp <span class="im">as</span> mc</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.outliers_influence <span class="im">as</span> influence</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.diagnostic <span class="im">as</span> diag</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.stattools <span class="im">as</span> stattools</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.anova <span class="im">as</span> anova</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.weightstats <span class="im">as</span> weightstats</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.libqsturng <span class="im">as</span> libqsturng</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.power <span class="im">as</span> power</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.proportion <span class="im">as</span> proportion</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.contingency_tables <span class="im">as</span> contingency_tables</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.multitest <span class="im">as</span> multitest</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.diagnostic <span class="im">as</span> diagnostic</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.correlation_tools <span class="im">as</span> correlation_tools</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> researchpy <span class="im">as</span> rp</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Import label encoder</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"whitegrid"</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC, LinearSVC</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> scale</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> RFE</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_validate</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_recall_curve</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="importing-the-dataset" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="importing-the-dataset"><span class="header-section-number">1.4</span> Importing the dataset</h2>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>inputFile <span class="op">=</span> <span class="st">"Dataset/primary.csv"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(inputFile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="basic-information-about-the-data" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="basic-information-about-the-data"><span class="header-section-number">1.5</span> Basic Information about the data</h2>
<div class="cell" data-execution_count="3">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shape of dataset is : </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Columns in dataset </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>df<span class="sc">.</span>info()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of dataset is : (45211, 23)
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 45211 entries, 0 to 45210
Data columns (total 23 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   age             45211 non-null  int64  
 1   job             45211 non-null  object 
 2   marital         45211 non-null  object 
 3   education       45211 non-null  object 
 4   default         45211 non-null  object 
 5   balance         45211 non-null  int64  
 6   housing         45211 non-null  object 
 7   loan            45211 non-null  object 
 8   contact         45211 non-null  object 
 9   day             45211 non-null  int64  
 10  month           45211 non-null  object 
 11  duration        45211 non-null  int64  
 12  campaign        45211 non-null  int64  
 13  pdays           45211 non-null  int64  
 14  previous        45211 non-null  int64  
 15  poutcome        45211 non-null  object 
 16  y               45211 non-null  int64  
 17  month_int       45211 non-null  int64  
 18  cons.conf.idx   45211 non-null  float64
 19  emp.var.rate    45211 non-null  float64
 20  euribor3m       45211 non-null  float64
 21  nr.employed     45211 non-null  float64
 22  cons.price.idx  45211 non-null  float64
dtypes: float64(5), int64(9), object(9)
memory usage: 7.9+ MB
Columns in dataset 
 None</code></pre>
</div>
</div>
<p>Here, we have 45211 variables and 23 columns.</p>
</section>
</section>
<section id="exploratory-data-analysis-eda" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Exploratory Data Analysis (EDA)</h1>
<p>Here we would explore the variables which might be important for subscription of term deposits.</p>
<section id="analysing-the-variables" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="analysing-the-variables"><span class="header-section-number">2.1</span> Analysing the variables</h2>
<section id="job-description" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="job-description"><span class="header-section-number">2.1.1</span> Job Description</h3>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># JOB</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,y<span class="op">=</span><span class="st">'job'</span>,hue<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Type of Job Distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>Text(0.5, 1.0, 'Type of Job Distribution')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-5-output-2.png" width="738" height="455"></p>
</div>
</div>
<p>People in management, technical are more likely to subscibe to the term deposit<br>
So we will explore them later.</p>
</section>
<section id="marital" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="marital"><span class="header-section-number">2.1.2</span> Marital</h3>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MARITAL</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,y<span class="op">=</span><span class="st">'marital'</span>,hue<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Type of marital Distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>Text(0.5, 1.0, 'Type of marital Distribution')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-6-output-2.png" width="707" height="455"></p>
</div>
</div>
<p>Married and Single are more likely to subscribe for term deposits rather than divorced. But this might also be because of less number of people being divorced in total.</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># EDUCATION </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,y<span class="op">=</span><span class="st">'education'</span>,hue<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Type of education Distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>Text(0.5, 1.0, 'Type of education Distribution')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-7-output-2.png" width="715" height="455"></p>
</div>
</div>
<p>There are unknown values in education that we need to get rid of.</p>
</section>
<section id="loan" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="loan"><span class="header-section-number">2.1.3</span> Loan</h3>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loan</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,y<span class="op">=</span><span class="st">'loan'</span>,hue<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Type of loan Distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>Text(0.5, 1.0, 'Type of loan Distribution')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-8-output-2.png" width="595" height="455"></p>
</div>
</div>
<p>People with personal loans are less likely to subscribe to term deposit but the difference here is not huge.</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Housing Loan</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,y<span class="op">=</span><span class="st">'housing'</span>,hue<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Type of housing Distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>Text(0.5, 1.0, 'Type of housing Distribution')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-9-output-2.png" width="595" height="455"></p>
</div>
</div>
<p>People with housing loans are less likely to subscribe to term deposit but the difference here is not huge.</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DEFAULT</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,y<span class="op">=</span><span class="st">'default'</span>,hue<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Type of default Distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>Text(0.5, 1.0, 'Type of default Distribution')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-10-output-2.png" width="602" height="455"></p>
</div>
</div>
<p>So people who have not paid back there loans and have credits, have not subcribed to the term deposit.</p>
<ul>
<li>people who have loans are subscribing to term deposit less.</li>
</ul>
</section>
<section id="contact" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="contact"><span class="header-section-number">2.1.4</span> Contact</h3>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CONTACT</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,y<span class="op">=</span><span class="st">'contact'</span>,hue<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Type of Contact Distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>Text(0.5, 1.0, 'Type of Contact Distribution')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-11-output-2.png" width="637" height="455"></p>
</div>
</div>
<ul>
<li>since the type of communication(cellular and telephone) is not really a good indicator of subcription, we drop this variable.</li>
</ul>
<section id="month" class="level4" data-number="2.1.4.1">
<h4 data-number="2.1.4.1" class="anchored" data-anchor-id="month"><span class="header-section-number">2.1.4.1</span> Month</h4>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MONTH</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(x <span class="op">=</span><span class="st">'month'</span>,hue<span class="op">=</span><span class="st">'y'</span>, data <span class="op">=</span> df)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Type of Months Distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>Text(0.5, 1.0, 'Type of Months Distribution')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-12-output-2.png" width="613" height="455"></p>
</div>
</div>
<p>Here,we see that most number of term deposit subscription is in the month of may while the least in the month of december.</p>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pieChart(x_var,title):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    yesNo <span class="op">=</span> df.groupby(x_var).size()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    yesNo.plot(kind<span class="op">=</span><span class="st">'pie'</span>, title<span class="op">=</span>title, figsize<span class="op">=</span>[<span class="dv">8</span>,<span class="dv">8</span>],</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>          autopct<span class="op">=</span><span class="kw">lambda</span> p: <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">%(</span><span class="sc">{:.0f}</span><span class="st">)'</span>.<span class="bu">format</span>(p,(p<span class="op">/</span><span class="dv">100</span>)<span class="op">*</span>yesNo.<span class="bu">sum</span>()))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="term-deposit" class="level3" data-number="2.1.5">
<h3 data-number="2.1.5" class="anchored" data-anchor-id="term-deposit"><span class="header-section-number">2.1.5</span> Term Deposit</h3>
<p>Distribution of y(target) variable</p>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pieChart(<span class="st">'y'</span>,<span class="st">'Percentage of yes and no target(term deposit)in dataset'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-14-output-1.png" width="611" height="630"></p>
</div>
</div>
<p>only 11.7% of enteries are for y=1, so our dataset is unbalanced.</p>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># POUTCOME</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>pieChart(<span class="st">'poutcome'</span>,<span class="st">'Distribution of poutcome in dataset'</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>df.poutcome.value_counts()</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">'poutcome'</span>).size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-15-output-1.png" width="611" height="630"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>poutcome
failure     4901
other       1840
success     1511
unknown    36959
dtype: int64</code></pre>
</div>
</div>
<p>There are <em>36959 unknown</em> values and 1840 values with other category. Since, 82% of entries are unknown, 4.07% other, we will directly drop this column.</p>
</section>
</section>
<section id="age-duration-and-balance" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="age-duration-and-balance"><span class="header-section-number">2.2</span> Age, duration and balance</h2>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting violen plot for duration and balance </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>f, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>,sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'For duration'</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>sns.violinplot( x<span class="op">=</span><span class="st">'y'</span>,y<span class="op">=</span><span class="st">'duration'</span>,  split<span class="op">=</span><span class="va">True</span>, inner<span class="op">=</span><span class="st">"quart"</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>], data<span class="op">=</span>df)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'For balance'</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>sns.violinplot( x<span class="op">=</span><span class="st">'y'</span>,y<span class="op">=</span><span class="st">'balance'</span>,  split<span class="op">=</span><span class="va">True</span>, inner<span class="op">=</span><span class="st">"quart"</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>], data<span class="op">=</span>df)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>sns.despine(left<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-16-output-1.png" width="605" height="455"></p>
</div>
</div>
<ul>
<li>There are outliers in duration and balance so we need to get rid of them.</li>
<li>people who have a high balance, are more likely to subscribe to term deposit.</li>
</ul>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>sns.violinplot( x<span class="op">=</span><span class="st">'y'</span>,y<span class="op">=</span><span class="st">'age'</span>,  split<span class="op">=</span><span class="va">True</span>, inner<span class="op">=</span><span class="st">"quart"</span>, data<span class="op">=</span>df)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Age distribution for each response variable'</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-17-output-1.png" width="597" height="455"></p>
</div>
</div>
<ul>
<li>No outliers</li>
<li>People who are old are more likely to subscribe to term deposit.</li>
</ul>
</section>
</section>
<section id="summary" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Summary</h1>
<section id="data-cleaning" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="data-cleaning"><span class="header-section-number">3.1</span> Data Cleaning</h2>
<ul>
<li>Contact is not useful so we drop it.</li>
<li>In poutcome, we have a lot of missing values so we drop it.<br>
</li>
<li>Day is not giving any relevant infomation so we drop it.</li>
<li>Removing the unknowns</li>
<li>Remove the outliers from balance and duration.</li>
</ul>
</section>
<section id="data-visualization" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="data-visualization"><span class="header-section-number">3.2</span> Data Visualization</h2>
</section>
</section>
<section id="data-cleaning-1" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Data Cleaning</h1>
<section id="dropping-the-column" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="dropping-the-column"><span class="header-section-number">4.1</span> Dropping the column</h2>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>clean_data <span class="op">=</span> df.drop([<span class="st">'contact'</span>,<span class="st">'poutcome'</span>,<span class="st">'day'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As most of the values of poutcome is unknown making the column unimportant in subsequent analysis. More over the day of the week has no significant relation to the subcription of term deposit neither cantact type. ## Removing unknown from job and education</p>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> clean_data.columns:</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> clean_data[i].dtype <span class="op">==</span> np.int64:</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># printing names and count using loop.</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> idx, name <span class="kw">in</span> <span class="bu">enumerate</span>(clean_data[i].value_counts().index.tolist()):</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> name <span class="op">==</span> <span class="st">'unknown'</span> <span class="kw">or</span> name <span class="op">==</span> <span class="st">'other'</span>:</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"for </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span>clean_data[i]<span class="sc">.</span>value_counts()[idx]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> clean_data[i].value_counts()[idx] <span class="op">&lt;</span> <span class="dv">15000</span>:</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"dropping rows with value as </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> in </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                    clean_data <span class="op">=</span> clean_data[clean_data[i] <span class="op">!=</span> name]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>for job
unknown : 288
dropping rows with value as unknown in job
for education
unknown : 1730
dropping rows with value as unknown in education</code></pre>
</div>
</div>
</section>
<section id="dropping-the-rows" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="dropping-the-rows"><span class="header-section-number">4.2</span> Dropping the rows</h2>
<section id="dropping-the-rows-where-values-are-3sd-away" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="dropping-the-rows-where-values-are-3sd-away"><span class="header-section-number">4.2.1</span> Dropping the rows where values are 3SD away</h3>
<p><em>Balance - Outliers</em></p>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>standard_deviation <span class="op">=</span> clean_data[[<span class="st">'balance'</span>]].std()</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>mean <span class="op">=</span> clean_data[[<span class="st">'balance'</span>]].mean()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>clean_data[<span class="st">'balance_outliers'</span>] <span class="op">=</span> clean_data[<span class="st">'balance'</span>]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>clean_data[<span class="st">'balance_outliers'</span>]<span class="op">=</span> zscore(clean_data[<span class="st">'balance_outliers'</span>])</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"removing entries before </span><span class="sc">{</span>mean <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>standard_deviation <span class="sc">}</span><span class="ss"> and after </span><span class="sc">{</span>mean <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>standard_deviation <span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>three_SD <span class="op">=</span> (clean_data[<span class="st">'balance_outliers'</span>]<span class="op">&gt;</span><span class="dv">3</span>) <span class="op">|</span> (clean_data[<span class="st">'balance_outliers'</span>]<span class="op">&lt;-</span><span class="dv">3</span> )</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>clean_data <span class="op">=</span> clean_data.drop(clean_data[three_SD].index, axis <span class="op">=</span> <span class="dv">0</span>, inplace <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>clean_data <span class="op">=</span> clean_data.drop(<span class="st">'balance_outliers'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>removing entries before balance   -7772.283533
dtype: float64 and after balance    10480.338218
dtype: float64</code></pre>
</div>
</div>
<p><em>Duration - Outliers</em></p>
</section>
<section id="dropping-rows-where-the-duration-of-calls-is-less-than-5sec-since-that-is-irrelevant" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="dropping-rows-where-the-duration-of-calls-is-less-than-5sec-since-that-is-irrelevant"><span class="header-section-number">4.2.2</span> Dropping rows where the duration of calls is less than 5sec since that is irrelevant</h3>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>less_5 <span class="op">=</span> (clean_data[<span class="st">'duration'</span>]<span class="op">&lt;</span><span class="dv">5</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>clean_data <span class="op">=</span> clean_data.drop(clean_data[less_5].index, axis <span class="op">=</span> <span class="dv">0</span>, inplace <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Changing unit of duration from seconds to minutes to make more sense</p>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>clean_data[<span class="st">'duration'</span>] <span class="op">=</span> clean_data[<span class="st">'duration'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> n:n<span class="op">/</span><span class="dv">60</span>).<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="data-visualization-1" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Data Visualization</h1>
<section id="contact-versus-subscription-month-wise" class="level3" data-number="5.0.1">
<h3 data-number="5.0.1" class="anchored" data-anchor-id="contact-versus-subscription-month-wise"><span class="header-section-number">5.0.1</span> Contact versus Subscription month wise</h3>
</section>
<section id="number-of-calls-versus-duration-and-affect-on-subscription" class="level3" data-number="5.0.2">
<h3 data-number="5.0.2" class="anchored" data-anchor-id="number-of-calls-versus-duration-and-affect-on-subscription"><span class="header-section-number">5.0.2</span> Number of calls versus Duration and affect on subscription</h3>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>dur_cam <span class="op">=</span> sns.lmplot(x<span class="op">=</span><span class="st">'duration'</span>, y<span class="op">=</span><span class="st">'campaign'</span>,data <span class="op">=</span> clean_data,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                     hue <span class="op">=</span> <span class="st">'y'</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                     fit_reg <span class="op">=</span> <span class="va">False</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                     scatter_kws<span class="op">=</span>{<span class="st">'alpha'</span>:<span class="fl">0.6</span>}, height <span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>plt.axis([<span class="dv">0</span>,<span class="dv">65</span>,<span class="dv">0</span>,<span class="dv">65</span>])</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Calls'</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Duration of Calls (Minutes)'</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'The Relationship between the Number and Duration of Calls (with y)'</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Annotation</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">5</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">"k"</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'Higher subscription rate when number of calls &lt;5 '</span>,xytext <span class="op">=</span> (<span class="dv">35</span>,<span class="dv">13</span>),</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>             arrowprops<span class="op">=</span><span class="bu">dict</span>(color <span class="op">=</span> <span class="st">'k'</span>, width<span class="op">=</span><span class="dv">1</span>),xy<span class="op">=</span>(<span class="dv">30</span>,<span class="dv">6</span>))</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-23-output-1.png" width="739" height="676"></p>
</div>
</div>
<p>Checking between pdays and previous as well</p>
<ol start="13" type="1">
<li><ul>
<li>pdays: number of days that passed by after the client was last contacted from a previous campaign (numeric; 999 means client was not previously contacted)</li>
</ul></li>
<li><ul>
<li>previous: number of contacts performed before this campaign and for this client (numeric)</li>
</ul></li>
</ol>
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>dur_cam <span class="op">=</span> sns.lmplot(x<span class="op">=</span><span class="st">'pdays'</span>, y<span class="op">=</span><span class="st">'previous'</span>,data <span class="op">=</span> clean_data,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                     hue <span class="op">=</span> <span class="st">'y'</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                     fit_reg <span class="op">=</span> <span class="va">False</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                     scatter_kws<span class="op">=</span>{<span class="st">'alpha'</span>:<span class="fl">0.6</span>}, height <span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.axis([0,65,0,65])</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'pdays'</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'previous'</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'The Relationship between number of contacts  and last contactbefore this campaign (with y)'</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-24-output-1.png" width="720" height="676"></p>
</div>
</div>
</section>
<section id="smart-question" class="level3" data-number="5.0.3">
<h3 data-number="5.0.3" class="anchored" data-anchor-id="smart-question"><span class="header-section-number">5.0.3</span> Smart Question</h3>
<p>Based on last contact info only number of contacts performed during this campaign is contributing a lot towards subscription rates.</p>
</section>
<section id="month-wise-subscription" class="level3" data-number="5.0.4">
<h3 data-number="5.0.4" class="anchored" data-anchor-id="month-wise-subscription"><span class="header-section-number">5.0.4</span> Month wise subscription</h3>
<div class="cell" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#converting y values </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># bankdata['y'] = bankdata['y'].apply(lambda x: 'no' if x == 'yes' else 1)</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># bankdata['y'] = bankdata['y'].astype('category')</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">#value count for each month</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>month <span class="op">=</span> clean_data[<span class="st">'month'</span>].value_counts().rename_axis(<span class="st">'month'</span>).reset_index(name<span class="op">=</span><span class="st">'counts'</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#for sequencing the month</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>m1_list<span class="op">=</span>[<span class="st">'jan'</span>,<span class="st">'feb'</span>,<span class="st">'mar'</span>,<span class="st">'apr'</span>,<span class="st">'may'</span>,<span class="st">'jun'</span>,<span class="st">'jul'</span>,<span class="st">'aug'</span>,<span class="st">'sep'</span>,<span class="st">'nov'</span>,<span class="st">'dec'</span>]</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>m1<span class="op">=</span>pd.DataFrame(m1_list,columns<span class="op">=</span>[<span class="st">'month'</span>])</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co">#now the dataset is sequeced</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>month <span class="op">=</span> m1.merge(month)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co">#month - counts</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co">#% of people contacted in that month </span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>month[<span class="st">'Contact Rate'</span>] <span class="op">=</span> month[<span class="st">'counts'</span>]<span class="op">*</span><span class="dv">100</span><span class="op">/</span>month[<span class="st">'counts'</span>].<span class="bu">sum</span>()</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co">#percentage of people contacted in that month </span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co"># y response </span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>month_y <span class="op">=</span> pd.crosstab(clean_data[<span class="st">'y'</span>],clean_data[<span class="st">'month'</span>]).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x<span class="op">/</span>x.<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co">#% of 0 and 1 for each month </span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>month_y <span class="op">=</span> month_y.transpose()</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>month_y.rename(columns <span class="op">=</span> {<span class="st">'y'</span>:<span class="st">'month'</span>,<span class="dv">0</span>:<span class="st">'no'</span>, <span class="dv">1</span>:<span class="st">'yes'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="co"># month_y</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="co"># y | no% | yes%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="25">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#month = month.merge(month_y)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>month[<span class="st">'yes'</span>] <span class="op">=</span> <span class="st">" "</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>month[<span class="st">'no'</span>] <span class="op">=</span> <span class="st">" "</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">#to make it in sequence </span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> addingCrossTab(): </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, val <span class="kw">in</span> <span class="bu">enumerate</span>(m1_list):</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print (i, ",",val)</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>        month[<span class="st">'yes'</span>].iloc[i]<span class="op">=</span>month_y.loc[val].loc[<span class="st">'yes'</span>]</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(month_y.loc[val].loc['yes'])</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        month[<span class="st">'no'</span>].iloc[i]<span class="op">=</span>month_y.loc[val].loc[<span class="st">'no'</span>]</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>addingCrossTab()  </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co">#print(month)      </span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co">#print(month_y)</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co"># month['Subscription Rate'] = month_y['yes']</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co"># month['% NotSubscription'] = month_y['no']</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>month.rename(columns <span class="op">=</span> {<span class="st">'yes'</span>:<span class="st">'Subscription Rate'</span>,<span class="st">'no'</span>:<span class="st">'NotSubscribed Rate'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co">#month.drop('month_int',axis = 1,inplace = True)</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(month)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   month  counts  Contact Rate Subscription Rate NotSubscribed Rate
0    jan    1310      3.134046              10.0               90.0
1    feb    2492      5.961865         16.332263          83.667737
2    mar     439      1.050264         53.758542          46.241458
3    apr    2772      6.631738         19.083694          80.916306
4    may   13050     31.220843          6.697318          93.302682
5    jun    4874     11.660566          10.56627           89.43373
6    jul    6550     15.670231          8.793893          91.206107
7    aug    5924     14.172588         10.820392          89.179608
8    sep     514      1.229694          47.66537           52.33463
9    nov    3679      8.801646         10.192987          89.807013
10   dec     195      0.466518         45.641026          54.358974</code></pre>
</div>
</div>
<div class="cell" data-execution_count="26">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>plot_month <span class="op">=</span> month[[<span class="st">'month'</span>,<span class="st">'Subscription Rate'</span>,<span class="st">'Contact Rate'</span>]].plot(x<span class="op">=</span><span class="st">'month'</span>,kind <span class="op">=</span><span class="st">'line'</span>,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                                                          figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">6</span>),</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                                                          marker <span class="op">=</span> <span class="st">'o'</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Subscription vs. Contact Rate by Month'</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Subscription and Contact Rate'</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Month'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>Text(0.5, 0, 'Month')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-27-output-2.png" width="812" height="529"></p>
</div>
</div>
<p>Maximum percentage of people have subscribed in the month of March but bank is contacting people more in the month of May. So it’s better to contact customer’s based on the subcription rate plot.</p>
</section>
<section id="social-and-economic-factors-in-month" class="level3" data-number="5.0.5">
<h3 data-number="5.0.5" class="anchored" data-anchor-id="social-and-economic-factors-in-month"><span class="header-section-number">5.0.5</span> Social and economic Factors in month</h3>
<div class="cell" data-execution_count="27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>month_social_economic <span class="op">=</span> clean_data[[<span class="st">'month'</span>,<span class="st">'cons.conf.idx'</span>,<span class="st">'emp.var.rate'</span>,<span class="st">'euribor3m'</span>,<span class="st">'nr.employed'</span>]].groupby([<span class="st">'month'</span>]).count().reset_index()</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>month_list<span class="op">=</span> [<span class="st">'jan'</span>,<span class="st">'feb'</span>,<span class="st">'mar'</span>,<span class="st">'apr'</span>,<span class="st">'may'</span>,<span class="st">'jun'</span>,<span class="st">'jul'</span>,<span class="st">'aug'</span>,<span class="st">'sep'</span>,<span class="st">'oct'</span>,<span class="st">'nov'</span>,<span class="st">'dec'</span>]</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>month_pd <span class="op">=</span> pd.DataFrame(month_list,columns<span class="op">=</span>[<span class="st">'month'</span>])</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>month_pd <span class="op">=</span> month_pd.merge(month_social_economic,on<span class="op">=</span><span class="st">'month'</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(month_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   month  cons.conf.idx  emp.var.rate  euribor3m  nr.employed
0    jan           1310          1310       1310         1310
1    feb           2492          2492       2492         2492
2    mar            439           439        439          439
3    apr           2772          2772       2772         2772
4    may          13050         13050      13050        13050
5    jun           4874          4874       4874         4874
6    jul           6550          6550       6550         6550
7    aug           5924          5924       5924         5924
8    sep            514           514        514          514
9    oct            661           661        661          661
10   nov           3679          3679       3679         3679
11   dec            195           195        195          195</code></pre>
</div>
</div>
<p>Based on the above table we can see that there is no distinguishable difference in the month of march or may from rest of all the month, so social and economic factor <strong>do not have major influence</strong> on the outcome.</p>
</section>
</section>
<section id="checking-the-financially-stable-population" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Checking the Financially stable population</h1>
<div class="cell" data-execution_count="28">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>data_vis <span class="op">=</span> clean_data.copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="job" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="job"><span class="header-section-number">6.1</span> Job</h2>
<div class="cell" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>y_job <span class="op">=</span> pd.crosstab(data_vis[<span class="st">'y'</span>],data_vis[<span class="st">'job'</span>]).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x<span class="op">/</span>x.<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>y_job <span class="op">=</span> y_job.transpose()</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>y_job.rename(columns <span class="op">=</span> {<span class="st">'y'</span>:<span class="st">'job'</span>,<span class="dv">0</span>:<span class="st">'no'</span>, <span class="dv">1</span>:<span class="st">'yes'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>jobs_sub <span class="op">=</span> y_job[<span class="st">'yes'</span>].sort_values(ascending <span class="op">=</span> <span class="va">True</span>).plot(kind <span class="op">=</span><span class="st">'barh'</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                                                                               </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Subscription Rate by Job'</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Subscription Rate'</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Job Category'</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Label each bar</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> patch_i, label <span class="kw">in</span> <span class="bu">zip</span>(jobs_sub.patches,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>                      y_job[<span class="st">'yes'</span>].sort_values(ascending <span class="op">=</span> <span class="va">True</span>).<span class="bu">round</span>(<span class="dv">1</span>).astype(<span class="bu">str</span>)):</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    jobs_sub.text(patch_i.get_width()<span class="op">+</span><span class="fl">1.5</span>, </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>                  patch_i.get_y()<span class="op">+</span> patch_i.get_height()<span class="op">-</span><span class="fl">0.5</span>, </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>                  label<span class="op">+</span><span class="st">'%'</span>, </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>                  ha <span class="op">=</span> <span class="st">'center'</span>, </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>                  va<span class="op">=</span><span class="st">'bottom'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-30-output-1.png" width="687" height="455"></p>
</div>
</div>
<div class="cell" data-execution_count="30">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>job_contact<span class="op">=</span>  data_vis[<span class="st">'job'</span>].value_counts().rename_axis(<span class="st">'job'</span>).reset_index(name<span class="op">=</span><span class="st">'counts'</span>)        </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>job_contact[<span class="st">'Contact Rate'</span>]<span class="op">=</span> job_contact[<span class="st">'counts'</span>]<span class="op">*</span><span class="dv">100</span><span class="op">/</span>job_contact[<span class="st">'counts'</span>].<span class="bu">sum</span>()  </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>job_contact[<span class="st">'Contact Rate'</span>] <span class="op">=</span> job_contact[<span class="st">'Contact Rate'</span>].<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>job_contact<span class="op">=</span>job_contact.drop([<span class="st">'counts'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># job_contact['Contact Rate']= job_contact['Contact Rate'].sort_values(ascending = False)</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>job_contact_plot <span class="op">=</span> job_contact.plot(x<span class="op">=</span><span class="st">'job'</span>,kind <span class="op">=</span><span class="st">'barh'</span>)  </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co">#.plot(kind ='barh')                                                </span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Contact Rate by Job'</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Contact Rate'</span>)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Job Category'</span>)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Label each bar</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> patch_i, label <span class="kw">in</span> <span class="bu">zip</span>(job_contact_plot.patches,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>                      job_contact[<span class="st">'Contact Rate'</span>].astype(<span class="bu">str</span>)):</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    job_contact_plot.text(patch_i.get_width()<span class="op">+</span><span class="fl">1.5</span>, </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>                  patch_i.get_y()<span class="op">+</span> patch_i.get_height()<span class="op">-</span><span class="fl">0.5</span>, </span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>                  label<span class="op">+</span><span class="st">'%'</span>, </span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>                  ha <span class="op">=</span> <span class="st">'center'</span>, </span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>                  va<span class="op">=</span><span class="st">'bottom'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-31-output-1.png" width="701" height="455"></p>
</div>
</div>
<p>People in blue color and managemnet jobs are contacted more, which should not be the case.</p>
</section>
<section id="balance" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="balance"><span class="header-section-number">6.2</span> Balance</h2>
<div class="cell" data-execution_count="31">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#max = 10399</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co">#min = -6847</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> balance_group(bal):</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    balGroup <span class="op">=</span> <span class="st">'Negative'</span> <span class="cf">if</span> bal <span class="op">&lt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">'low balance'</span> <span class="cf">if</span> bal <span class="op">&lt;</span> <span class="dv">1000</span> <span class="cf">else</span> <span class="st">'moderate balance'</span> <span class="cf">if</span> bal <span class="op">&lt;</span> <span class="dv">2500</span> <span class="cf">else</span> <span class="st">'high balance'</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> balGroup</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>data_vis[<span class="st">'balGroup'</span>] <span class="op">=</span> data_vis[<span class="st">'balance'</span>].<span class="bu">apply</span>(balance_group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>checking the subscription based on y value</p>
<div class="cell" data-execution_count="32">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>y_balance <span class="op">=</span> pd.crosstab(data_vis[<span class="st">'y'</span>],data_vis[<span class="st">'balGroup'</span>]).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x<span class="op">/</span>x.<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>y_balance <span class="op">=</span> y_balance.transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Checking the subscriptions in each balance groups</p>
<div class="cell" data-execution_count="33">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>bal <span class="op">=</span> pd.DataFrame(data_vis[<span class="st">'balGroup'</span>].value_counts().rename_axis(<span class="st">'balGroup'</span>).reset_index(name<span class="op">=</span><span class="st">'counts'</span>))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>bal_y <span class="op">=</span> bal.merge(y_balance,on<span class="op">=</span><span class="st">'balGroup'</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>bal_y[<span class="st">'% Contacted'</span>] <span class="op">=</span> bal_y[<span class="st">'counts'</span>]<span class="op">*</span><span class="dv">100</span><span class="op">/</span>bal_y[<span class="st">'counts'</span>].<span class="bu">sum</span>()</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>bal_y[<span class="st">'% Subscription'</span>] <span class="op">=</span> bal_y[<span class="dv">1</span>]</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>bal_y.rename(columns <span class="op">=</span> {<span class="st">'y'</span>:<span class="st">'month'</span>,<span class="dv">0</span>:<span class="st">'no'</span>, <span class="dv">1</span>:<span class="st">'yes'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>bal_y <span class="op">=</span> bal_y.drop([<span class="st">'counts'</span>,<span class="st">'no'</span>,<span class="st">'yes'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bal_y)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>bal_list <span class="op">=</span> [<span class="st">'Negative'</span>,<span class="st">'low balance'</span>, <span class="st">'moderate balance'</span>,<span class="st">'high balance'</span>]</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>balanceGroupInfo <span class="op">=</span>pd.DataFrame(bal_list,columns<span class="op">=</span>[<span class="st">'balanceGroup'</span>])</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>balanceGroupInfo[<span class="st">'Contact Rate'</span>] <span class="op">=</span> <span class="st">" "</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>balanceGroupInfo[<span class="st">'Subscription Rate'</span>] <span class="op">=</span> <span class="st">" "</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>bal_y <span class="op">=</span> bal_y.set_index([<span class="st">'balGroup'</span>])</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,val <span class="kw">in</span> <span class="bu">enumerate</span>(bal_list):</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>     balanceGroupInfo[<span class="st">'Contact Rate'</span>].iloc[i]<span class="op">=</span>bal_y.loc[val].loc[<span class="st">'% Contacted'</span>]</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>     balanceGroupInfo[<span class="st">'Subscription Rate'</span>].iloc[i]<span class="op">=</span>bal_y.loc[val].loc[<span class="st">'% Subscription'</span>]</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(balanceGroupInfo)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="co">#bal['bal'] = [1,2,0,3]</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="co">#bal = bal.sort_values('bal',ascending = True)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           balGroup  % Contacted  % Subscription
0       low balance    60.339143       10.503513
1  moderate balance    17.399906       14.036275
2      high balance    13.709374       16.715341
3          Negative     8.551578        5.700909
       balanceGroup Contact Rate Subscription Rate
0          Negative     8.551578          5.700909
1       low balance    60.339143         10.503513
2  moderate balance    17.399906         14.036275
3      high balance    13.709374         16.715341</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>balanceGroupInfo.plot(x<span class="op">=</span><span class="st">'balanceGroup'</span>, kind<span class="op">=</span><span class="st">'bar'</span>, stacked<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">'Balance Group Contact Rates and Subscription'</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-35-output-1.png" width="569" height="558"></p>
</div>
</div>
<p>People with moderate to high balance, are contacted less but they have high subscription rates so bank should target them more.</p>
<p>Balance Group versus Job</p>
<div class="cell" data-execution_count="35">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add the values for 1 </span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>job_balance <span class="op">=</span> pd.DataFrame(data_vis.groupby([<span class="st">'job'</span>,<span class="st">'balGroup'</span>])[<span class="st">'y'</span>].<span class="bu">sum</span>())</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># total number of values </span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>job_balance_count <span class="op">=</span> pd.DataFrame(data_vis.groupby([<span class="st">'job'</span>,<span class="st">'balGroup'</span>])[<span class="st">'y'</span>].count())</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>job_balance[<span class="st">'y'</span>] <span class="op">=</span> (job_balance[<span class="st">'y'</span>]<span class="op">/</span>job_balance_count[<span class="st">'y'</span>])<span class="op">*</span><span class="dv">100</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>job_balance <span class="op">=</span> job_balance.unstack()</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>job_balance <span class="op">=</span> job_balance.plot(kind<span class="op">=</span><span class="st">'bar'</span>,figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Subscription Rates for each balance group in job category'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>Text(0.5, 1.0, 'Subscription Rates for each balance group in job category')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-36-output-2.png" width="792" height="606"></p>
</div>
</div>
<p>Student and Retired are more likely to subscribe and usually have moderate to high balance.</p>
<div class="cell" data-execution_count="36">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>job_balance_count1 <span class="op">=</span> job_balance_count.unstack()</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>job_balance_count1 <span class="op">=</span> job_balance_count1.plot(kind<span class="op">=</span><span class="st">'bar'</span>,figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Contact for each balance group in job category'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>Text(0.5, 1.0, 'Contact for each balance group in job category')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-37-output-2.png" width="809" height="606"></p>
</div>
</div>
</section>
<section id="loan-1" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="loan-1"><span class="header-section-number">6.3</span> Loan</h2>
<p>covered loan in initial EDA</p>
<div class="cell" data-execution_count="37">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>data_encode <span class="op">=</span> data_vis.copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="getting-data-ready-for-modelling" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Getting Data Ready for Modelling</h1>
<section id="encoding" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="encoding"><span class="header-section-number">7.1</span> Encoding</h2>
<p>One Hot Encoding</p>
<div class="cell" data-execution_count="38">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>data_encode <span class="op">=</span> pd.get_dummies(data_encode, columns <span class="op">=</span> [<span class="st">'housing'</span>])</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>data_encode <span class="op">=</span> pd.get_dummies(data_encode, columns <span class="op">=</span> [<span class="st">'loan'</span>])</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>data_encode <span class="op">=</span> pd.get_dummies(data_encode, columns <span class="op">=</span> [<span class="st">'default'</span>])</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>data_encode <span class="op">=</span> pd.get_dummies(data_encode, columns <span class="op">=</span> [<span class="st">'job'</span>])</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>data_encode <span class="op">=</span> pd.get_dummies(data_encode, columns <span class="op">=</span> [<span class="st">'education'</span>])</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>data_encode <span class="op">=</span> pd.get_dummies(data_encode, columns <span class="op">=</span> [<span class="st">'marital'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Sin - Cos encoding</p>
<div class="cell" data-execution_count="39">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> pi</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sin_transformation(x):</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>x<span class="op">-</span><span class="dv">1</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    sin_x <span class="op">=</span> math.sin((<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>x)<span class="op">/</span><span class="dv">11</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sin_x</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cos_transformation(x):</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>x<span class="op">-</span><span class="dv">1</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    cos_x <span class="op">=</span> math.cos((<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>x)<span class="op">/</span><span class="dv">11</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cos_x</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>data_encode[<span class="st">'sin_month'</span>] <span class="op">=</span> data_encode[<span class="st">'month_int'</span>].<span class="bu">apply</span>(sin_transformation) </span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>data_encode[<span class="st">'cos_month'</span>] <span class="op">=</span> data_encode[<span class="st">'month_int'</span>].<span class="bu">apply</span>(cos_transformation)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="40">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>data_encode,x<span class="op">=</span><span class="st">'sin_month'</span>,y<span class="op">=</span><span class="st">'cos_month'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="101">
<pre><code>&lt;AxesSubplot: xlabel='sin_month', ylabel='cos_month'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-41-output-2.png" width="610" height="435"></p>
</div>
</div>
<p>Label Encoding</p>
<div class="cell" data-execution_count="41">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>data_encode<span class="op">=</span> data_encode.drop([<span class="st">'month'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co">#data_encode= data_encode.drop(['month_int'],axis=1)</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>data_encode <span class="op">=</span> data_encode.drop([<span class="st">'balGroup'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>data_encode <span class="op">=</span> data_encode.drop([<span class="st">'pdays'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Checkpoint</p>
<div class="cell" data-execution_count="42">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data_encode.to_csv('Dataset/final_encoded.csv',index=False)</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#data_encode =  pd.read_csv('Dataset/final_encoded.csv')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="43">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>data_model <span class="op">=</span> data_encode.copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="dropping-the-unecessary-varibles-for-modelling" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="dropping-the-unecessary-varibles-for-modelling"><span class="header-section-number">7.1.1</span> Dropping the unecessary varibles for modelling</h3>
<div class="cell" data-execution_count="44">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>data_model<span class="op">=</span>data_model.drop([<span class="st">'cons.conf.idx'</span>, <span class="st">'emp.var.rate'</span>, <span class="st">'euribor3m'</span>, <span class="st">'nr.employed'</span>,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'cons.price.idx'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="splitting-our-dataset" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Splitting our Dataset</h1>
<div class="cell" data-execution_count="45">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dropping y to extract x variables </span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> data_model.drop([<span class="st">'y'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co">#y variables</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_model[<span class="st">'y'</span>]</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co">#splitting the dataset </span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>x_train,x_test,y_train,y_test <span class="op">=</span> train_test_split(x,y,test_size<span class="op">=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="balancing-our-dataset" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Balancing Our Dataset</h1>
<div class="cell" data-execution_count="46">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>sm <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>train_sx, train_sy <span class="op">=</span> sm.fit_resample(x_train, y_train)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>test_sx, test_sy <span class="op">=</span> sm.fit_resample(x_test, y_test)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co">#printing x and y values </span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>np.bincount(train_sy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>array([30035, 30035], dtype=int64)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="47">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>train_sx[<span class="st">'sin_month'</span>] <span class="op">=</span> train_sx[<span class="st">'month_int'</span>].<span class="bu">apply</span>(sin_transformation) </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>train_sx[<span class="st">'cos_month'</span>] <span class="op">=</span> train_sx[<span class="st">'month_int'</span>].<span class="bu">apply</span>(cos_transformation) </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>train_sx,x<span class="op">=</span><span class="st">'sin_month'</span>,y<span class="op">=</span><span class="st">'cos_month'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="108">
<pre><code>&lt;AxesSubplot: xlabel='sin_month', ylabel='cos_month'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-48-output-2.png" width="610" height="435"></p>
</div>
</div>
<div class="cell" data-execution_count="48">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>train_sx<span class="op">=</span> train_sx.drop([<span class="st">'month_int'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>test_sx<span class="op">=</span>test_sx.drop([<span class="st">'month_int'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="49">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>x_train<span class="op">=</span> x_train.drop([<span class="st">'month_int'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>x_test<span class="op">=</span>x_test.drop([<span class="st">'month_int'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Checkpoint 2</p>
<div class="cell" data-execution_count="50">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>train_balanced <span class="op">=</span> pd.concat([train_sx, train_sy], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>train_unbalanced <span class="op">=</span> pd.concat([x_train, y_train], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>test_unbalanced <span class="op">=</span> pd.concat([x_test, y_test], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>test_balanced <span class="op">=</span> pd.concat([test_sx, test_sy], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># train_balanced.to_csv('Dataset/train_balanced.csv',index=False)</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co"># train_unbalanced.to_csv('Dataset/train_unbalanced.csv',index=False)</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="co"># test_unbalanced.to_csv('Dataset/test_unbalanced.csv',index=False)</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co"># test_balanced.to_csv('Dataset/test_balanced.csv',index=False)</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Before Smote")</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"for training : {np.bincount(y_train)}")</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"for testing : {np.bincount(y_test)}")</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="co"># print("After smote")</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"for training : {np.bincount(y_res)}")</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"for testing : {np.bincount(test_sy)}")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="51">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>balanced_train<span class="op">=</span> pd.read_csv(<span class="st">'Dataset/train_balanced.csv'</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>balanced_test<span class="op">=</span> pd.read_csv(<span class="st">'Dataset/test.csv'</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>unbalanced_train<span class="op">=</span> pd.read_csv(<span class="st">'Dataset/train_unbalanced.csv'</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>unbalanced_test<span class="op">=</span> pd.read_csv(<span class="st">'Dataset/test.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="52">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># define standard scaler</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># transform data</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>balanced_train[[<span class="st">'age'</span>,<span class="st">'balance'</span>,<span class="st">'duration'</span>]]<span class="op">=</span> scaler.fit_transform(balanced_train[[<span class="st">'age'</span>,<span class="st">'balance'</span>,<span class="st">'duration'</span>]])</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>balanced_test[[<span class="st">'age'</span>,<span class="st">'balance'</span>,<span class="st">'duration'</span>]]<span class="op">=</span> scaler.fit_transform(balanced_test[[<span class="st">'age'</span>,<span class="st">'balance'</span>,<span class="st">'duration'</span>]])</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>unbalanced_train[[<span class="st">'age'</span>,<span class="st">'balance'</span>,<span class="st">'duration'</span>]]<span class="op">=</span> scaler.fit_transform(unbalanced_train[[<span class="st">'age'</span>,<span class="st">'balance'</span>,<span class="st">'duration'</span>]])</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>unbalanced_test[[<span class="st">'age'</span>,<span class="st">'balance'</span>,<span class="st">'duration'</span>]]<span class="op">=</span> scaler.fit_transform(unbalanced_test[[<span class="st">'age'</span>,<span class="st">'balance'</span>,<span class="st">'duration'</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="53">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> unbalanced_train.drop([<span class="st">'y'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> unbalanced_test.drop([<span class="st">'y'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> unbalanced_train[<span class="st">'y'</span>]</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> unbalanced_test[<span class="st">'y'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="54">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>bx_train <span class="op">=</span> balanced_train.drop([<span class="st">'y'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>bx_test <span class="op">=</span> balanced_test.drop([<span class="st">'y'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>by_train <span class="op">=</span> balanced_train[<span class="st">'y'</span>]</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>by_test <span class="op">=</span> balanced_test[<span class="st">'y'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="logistic-regression" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Logistic Regression</h1>
<p>Performing Logistic Regression on both balanced and unbalanced dataset. RFE is used in selecting the most important features ## Unbalanced Dataset</p>
<div class="cell" data-execution_count="55">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>rfe_model <span class="op">=</span> RFE(LogisticRegression(solver<span class="op">=</span><span class="st">'lbfgs'</span>, max_iter<span class="op">=</span><span class="dv">1000</span>), step<span class="op">=</span> <span class="dv">25</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>rfe_model <span class="op">=</span> rfe_model.fit(x_train,y_train)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># feature selection</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print(rfe_model.support_)</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co">#print(rfe_model.ranking_)</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>selected_columns <span class="op">=</span> x_train.columns[rfe_model.support_]</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>list_column<span class="op">=</span> selected_columns.tolist()</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>list_column.append(<span class="st">'age'</span>)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>list_column.append(<span class="st">'balance'</span>)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="co">#list_column.append('sin_month')</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Columns selected by RE </span><span class="sc">{</span>list_column<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>X_train_final <span class="op">=</span> x_train[list_column]</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>X_test_final <span class="op">=</span> x_test[list_column]</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a><span class="co">#X_train_final['balance','age'] = x_train['balance','age']</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a><span class="co">#X_test_final['balance','age'] = x_test['balance','age']</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Columns selected by RE ['duration', 'euribor3m', 'cons.price.idx', 'job_blue-collar', 'job_retired', 'job_student', 'education_primary', 'education_tertiary', 'marital_single', 'housing_no', 'housing_yes', 'loan_no', 'loan_yes', 'poutcome_failure', 'poutcome_success', 'month_apr', 'month_aug', 'month_feb', 'month_jan', 'month_jul', 'month_jun', 'month_mar', 'month_nov', 'month_oct', 'age', 'balance']</code></pre>
</div>
</div>
<p>As we can see from RFE, the most relevant features are :</p>
<ul>
<li>Duration</li>
<li>Housing</li>
<li>Loan</li>
<li>Job</li>
<li>Education</li>
<li>cos_month</li>
</ul>
<p>From other features selection techniques and EDA, we can see that ‘age’ and ‘balance’ also contrubuted to the subscrption, so we added up these variables as well.</p>
<p>Applying model with selected features</p>
<div class="cell" data-execution_count="56">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>lr <span class="op">=</span> LogisticRegression(random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>lr.fit(X_train_final, y_train)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> lr.predict(X_test_final)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy for training set </span><span class="sc">{</span>accuracy_score(y_train, lr.predict(X_train_final))<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy for testing set </span><span class="sc">{</span>accuracy_score(y_test, y_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Confusion matrix </span><span class="ch">\n</span><span class="sc">{</span>confusion_matrix(y_test, y_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>classification_report(y_test, y_pred)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy for training set 0.8717311715481172
Accuracy for testing set 0.8713389121338913
Confusion matrix 
[[4759  148]
 [ 590  239]]
              precision    recall  f1-score   support

           0       0.89      0.97      0.93      4907
           1       0.62      0.29      0.39       829

    accuracy                           0.87      5736
   macro avg       0.75      0.63      0.66      5736
weighted avg       0.85      0.87      0.85      5736
</code></pre>
</div>
</div>
<p>Here, the accuracy is 89% but the precision(0.59) and recall rate value(0.20) is low. And we also check on the balanced dataset since the low recall rate might be caused because of the less number of y = 1 value.</p>
</section>
<section id="balanced-dataset" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Balanced Dataset</h1>
<div class="cell" data-execution_count="57">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>rfe_model <span class="op">=</span> RFE(LogisticRegression(solver<span class="op">=</span><span class="st">'lbfgs'</span>, max_iter<span class="op">=</span><span class="dv">1000</span>), step<span class="op">=</span> <span class="dv">25</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>rfe_model <span class="op">=</span> rfe_model.fit(bx_train,by_train)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># feature selection</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print(rfe_model.support_)</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co">#print(rfe_model.ranking_)</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>selected_columns <span class="op">=</span> bx_train.columns[rfe_model.support_]</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Columns selected by RE </span><span class="sc">{</span>selected_columns<span class="sc">.</span>tolist()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>list_column<span class="op">=</span> selected_columns.tolist()</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>list_column.append(<span class="st">'age'</span>)</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>list_column.append(<span class="st">'balance'</span>)</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a><span class="co">#list_column.append('sin_month')</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>list_column.append(<span class="st">'duration'</span>)</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="co">#list_column.append('cos_month')</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a><span class="co">#balanced dataset </span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>bX_train_final <span class="op">=</span> bx_train[list_column]</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>bX_test_final <span class="op">=</span> bx_test[list_column]</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a><span class="co">#unbalanced test dataset</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>ubx_test_final <span class="op">=</span> x_test[list_column]</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>lr_b <span class="op">=</span> LogisticRegression(random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>lr_b.fit(bX_train_final, by_train)</span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>by_pred <span class="op">=</span> lr_b.predict(ubx_test_final)</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy for training set </span><span class="sc">{</span>accuracy_score(by_train, lr_b.predict(bX_train_final))<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy for testing set </span><span class="sc">{</span>accuracy_score(y_test, by_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Confusion matrix </span><span class="ch">\n</span><span class="sc">{</span>confusion_matrix(y_test, by_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>classification_report(y_test, by_pred)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Columns selected by RE ['duration', 'cons.price.idx', 'job_admin.', 'job_blue-collar', 'job_management', 'job_self-employed', 'job_services', 'job_technician', 'job_unemployed', 'education_primary', 'education_secondary', 'education_tertiary', 'marital_divorced', 'marital_married', 'marital_single', 'housing_no', 'housing_yes', 'loan_yes', 'poutcome_failure', 'month_apr', 'month_aug', 'month_jul', 'month_may', 'month_nov']</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy for training set 0.9064744536702155
Accuracy for testing set 0.8516387726638772
Confusion matrix 
[[4440  467]
 [ 384  445]]
              precision    recall  f1-score   support

           0       0.92      0.90      0.91      4907
           1       0.49      0.54      0.51       829

    accuracy                           0.85      5736
   macro avg       0.70      0.72      0.71      5736
weighted avg       0.86      0.85      0.85      5736
</code></pre>
</div>
</div>
<p>Here, important features are * Housing * Loan * Job * Education * Marital Status</p>
<p>We also added the important features from unbalaced dataset * Duration * Age * Month * Balance</p>
<p>Here even though the precision and recall have improved, and accuracy has dropped down, but the important relationships are lost since the training data now is artificially generated datapoints. We will try to find the optimal cut-off value for original dataset and compare it with the model for balanced data.</p>
<section id="deciding-cut-off-value-for-logistic-regression---unbalance" class="level3" data-number="11.0.1">
<h3 data-number="11.0.1" class="anchored" data-anchor-id="deciding-cut-off-value-for-logistic-regression---unbalance"><span class="header-section-number">11.0.1</span> Deciding cut off value for logistic regression - Unbalance</h3>
<p>But to have good values for cut-off we would try to find a cutoff where the precision and recall values are decent</p>
<div class="cell" data-execution_count="58">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision-Recall vs Threshold</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co">#y_pred=logit.predict(x_test)</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>y_pred_probs<span class="op">=</span>lr.predict_proba(X_test_final) </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># probs_y is a 2-D array of probability of being labeled as 0 (first </span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co"># column of array) vs 1 (2nd column in array)</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>precision, recall, thresholds <span class="op">=</span> precision_recall_curve(y_test, y_pred_probs[:, <span class="dv">1</span>]) </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co">#retrieve probability of being 1(in second column of probs_y)</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>pr_auc <span class="op">=</span> metrics.auc(recall, precision)</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Precision-Recall vs Threshold Chart"</span>)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>plt.plot(thresholds, precision[: <span class="op">-</span><span class="dv">1</span>], <span class="st">"b--"</span>, label<span class="op">=</span><span class="st">"Precision"</span>)</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>plt.plot(thresholds, recall[: <span class="op">-</span><span class="dv">1</span>], <span class="st">"r--"</span>, label<span class="op">=</span><span class="st">"Recall"</span>)</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Precision, Recall"</span>)</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Threshold"</span>)</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"lower left"</span>)</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Based on plot we would choose 0.25 as cut off "</span>)</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>thres <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> np.where(y_pred_probs[:,<span class="dv">1</span>]<span class="op">&gt;</span>thres,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy for testing set </span><span class="sc">{</span>accuracy_score(y_test, y_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Confusion matrix </span><span class="ch">\n</span><span class="sc">{</span>confusion_matrix(y_test, y_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>classification_report(y_test, y_pred)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Based on plot we would choose 0.25 as cut off 
Accuracy for testing set 0.8589609483960948
Confusion matrix 
[[4447  460]
 [ 349  480]]
              precision    recall  f1-score   support

           0       0.93      0.91      0.92      4907
           1       0.51      0.58      0.54       829

    accuracy                           0.86      5736
   macro avg       0.72      0.74      0.73      5736
weighted avg       0.87      0.86      0.86      5736
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-59-output-2.png" width="593" height="455" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Optimal Cutoff at 0.25</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Here as after applying feature selection, finding optimized cut-off, we are able to achieve higher accuracy with optimal precision and recall. Resulting from the comparison, we would continue our modellings with unbalance dataset.</p>
</section>
<section id="smart-question-5-the-optimal-cut-off-value-for-classification-of-our-imbalance-dataset." class="level3" data-number="11.0.2">
<h3 data-number="11.0.2" class="anchored" data-anchor-id="smart-question-5-the-optimal-cut-off-value-for-classification-of-our-imbalance-dataset."><span class="header-section-number">11.0.2</span> Smart Question 5: The optimal cut off value for classification of our imbalance dataset.</h3>
<p><strong>Answer</strong>: The optimal cut off value for our imbalance dataset is 0.25 as the precision- recall chart indicated.</p>
</section>
<section id="smart-question-2-since-the-dataset-is-imbalanced-will-down-samplingup-sampling-or-other-techniques-improve-upon-the-accuracy-of-models." class="level3" data-number="11.0.3">
<h3 data-number="11.0.3" class="anchored" data-anchor-id="smart-question-2-since-the-dataset-is-imbalanced-will-down-samplingup-sampling-or-other-techniques-improve-upon-the-accuracy-of-models."><span class="header-section-number">11.0.3</span> SMART Question 2: Since the dataset is imbalanced, will down sampling/up sampling or other techniques improve upon the accuracy of models.</h3>
<p><strong>Answer</strong>: As observed from above there is a slight improvement in accuracy, precision and recall after we apply SMOTE, but that improvement can also be acheived by adjusting the cut off value as well. So, we should always try adjusting cut-off first, before upsampling.</p>
<p>For ROC - AUC curve refer (<a href="#fig-roc-curve">Figure&nbsp;1</a>).<br>
For precision recall curve refer(<a href="#fig-pr-curve">Figure&nbsp;2</a>).</p>
</section>
</section>
<section id="decision-tree" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Decision Tree</h1>
<section id="feature-selection" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="feature-selection"><span class="header-section-number">12.1</span> Feature Selection</h2>
<div class="cell" data-execution_count="59">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># feature selection</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>dtc <span class="op">=</span> DecisionTreeClassifier()</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>dtc.fit(x_train, y_train)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>importance <span class="op">=</span> dtc.feature_importances_</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [] </span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>imp <span class="op">=</span> []</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,v <span class="kw">in</span> <span class="bu">enumerate</span>(importance):</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> v <span class="op">&gt;</span><span class="fl">0.01</span>:</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Feature </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> variable </span><span class="sc">{</span>x_train<span class="sc">.</span>columns[i]<span class="sc">}</span><span class="ss"> score </span><span class="sc">{</span>v<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>        features.append(x_train.columns[i])</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>        imp.append(v)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Important features from decision treee are : </span><span class="ch">\n</span><span class="sc">{</span>features<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>pyplot.bar([x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(importance))], importance)</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>pyplot.show()</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>x_train_dt <span class="op">=</span> x_train[features]</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>x_test_dt <span class="op">=</span> x_test[features]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Feature 0 variable age score 0.09
Feature 1 variable balance score 0.10
Feature 2 variable day score 0.09
Feature 3 variable duration score 0.28
Feature 4 variable campaign score 0.03
Feature 5 variable pdays score 0.07
Feature 6 variable previous score 0.01
Feature 7 variable cons.conf.idx score 0.01
Feature 8 variable emp.var.rate score 0.03
Feature 9 variable euribor3m score 0.02
Feature 11 variable cons.price.idx score 0.03
Feature 16 variable job_management score 0.01
Feature 24 variable education_secondary score 0.01
Feature 29 variable housing_no score 0.03
Feature 30 variable housing_yes score 0.01
Feature 35 variable poutcome_failure score 0.05
Important features from decision treee are : 
['age', 'balance', 'day', 'duration', 'campaign', 'pdays', 'previous', 'cons.conf.idx', 'emp.var.rate', 'euribor3m', 'cons.price.idx', 'job_management', 'education_secondary', 'housing_no', 'housing_yes', 'poutcome_failure']</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-60-output-2.png" width="581" height="415"></p>
</div>
</div>
<p>Features selected from this algorithm are</p>
<ul>
<li>Age</li>
<li>Balance</li>
<li>Duration</li>
<li>Campaign</li>
<li>Previous</li>
<li>Housing</li>
<li>Job</li>
<li>Education</li>
<li>Marital</li>
<li>Month - Sin,cos</li>
</ul>
<p>We have all the important features from EDA here</p>
</section>
<section id="hyperparameter-tuning" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="hyperparameter-tuning"><span class="header-section-number">12.2</span> Hyperparameter tuning</h2>
<p>For tuning the hyperparameter’s we will use GridSearch CV.</p>
<div class="cell" data-execution_count="60">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a dictionary of parameters to use in GridSearchCV</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'criterion'</span>:  [<span class="st">'gini'</span>, <span class="st">'entropy'</span>],</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>:  [<span class="va">None</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>],</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_features'</span>: [<span class="va">None</span>, <span class="st">'sqrt'</span>, <span class="st">'log2'</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>],</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'splitter'</span>: [<span class="st">'best'</span>, <span class="st">'random'</span>]</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> GridSearchCV(</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    estimator<span class="op">=</span>DecisionTreeClassifier(),</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    param_grid<span class="op">=</span>params,</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    cv<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>clf.fit(x_train_dt, y_train)</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Best parameters from Grid Search CV : </span><span class="ch">\n</span><span class="sc">{</span>clf<span class="sc">.</span>best_params_<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 5 folds for each of 168 candidates, totalling 840 fits</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best parameters from Grid Search CV : 
{'criterion': 'gini', 'max_depth': 6, 'max_features': None, 'splitter': 'best'}</code></pre>
</div>
</div>
<p>Training model based on the parameters we got from Grid SearchCV.</p>
<div class="cell" data-execution_count="61">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>dtc <span class="op">=</span> DecisionTreeClassifier(criterion<span class="op">=</span><span class="st">'entropy'</span>,max_depth<span class="op">=</span><span class="dv">8</span>,max_features<span class="op">=</span> <span class="fl">0.8</span>,splitter<span class="op">=</span><span class="st">'best'</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>dtc.fit(x_train_dt,y_train )</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>dtcprediction <span class="op">=</span> dtc.predict(x_test_dt)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(accuracy_score(y_test, dtcprediction))</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, dtcprediction))</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, dtcprediction))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.8767433751743375
[[4604  303]
 [ 404  425]]
              precision    recall  f1-score   support

           0       0.92      0.94      0.93      4907
           1       0.58      0.51      0.55       829

    accuracy                           0.88      5736
   macro avg       0.75      0.73      0.74      5736
weighted avg       0.87      0.88      0.87      5736
</code></pre>
</div>
</div>
<p>From the decision tree we have better precision, recall, accuracy and thus better f1 score. Hence, decision tree is performing better than logistic regression.</p>
<p>AUC Curve : <a href="#fig-roc-curve">Figure&nbsp;1</a><br>
Precision Recall Curve : <a href="#fig-pr-curve">Figure&nbsp;2</a></p>
</section>
</section>
<section id="random-forest" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Random Forest</h1>
<section id="feature-selection-1" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="feature-selection-1"><span class="header-section-number">13.1</span> Feature Selection</h2>
<div class="cell" data-execution_count="62">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>rfc <span class="op">=</span> RandomForestClassifier()</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>rfc.fit(x_train, y_train)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>importance_rfc <span class="op">=</span> rfc.feature_importances_</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>features_rfc <span class="op">=</span> [] </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,v <span class="kw">in</span> <span class="bu">enumerate</span>(importance_rfc):</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> v <span class="op">&gt;</span><span class="fl">0.01</span>:</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(f"Feature {i} variable {balanced_train.columns[i]} score {v}")</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>        features_rfc.append(balanced_train.columns[i])</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Important features from random forest :</span><span class="ch">\n</span><span class="sc">{</span>features_rfc<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>pyplot.bar([x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(importance_rfc))], importance_rfc)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>pyplot.show()</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a><span class="co">#selecting important features</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>x_train_rf <span class="op">=</span> x_train[features_rfc]</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>x_test_rf <span class="op">=</span> x_test[features_rfc]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Important features from random forest :
['age', 'balance', 'day', 'duration', 'campaign', 'pdays', 'previous', 'cons.conf.idx', 'emp.var.rate', 'euribor3m', 'nr.employed', 'cons.price.idx', 'job_management', 'job_technician', 'education_secondary', 'education_tertiary', 'marital_married', 'marital_single', 'housing_no', 'housing_yes', 'poutcome_failure', 'poutcome_success']</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-63-output-2.png" width="581" height="415"></p>
</div>
</div>
</section>
<section id="hyperparameter-tuning-1" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="hyperparameter-tuning-1"><span class="header-section-number">13.2</span> Hyperparameter Tuning</h2>
<div class="cell" data-execution_count="63">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the parameter grid based on the results of random search </span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'bootstrap'</span>: [<span class="va">True</span>],</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: [<span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">100</span>, <span class="dv">110</span>],</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_features'</span>: [<span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">1000</span>]</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a based model</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>rf <span class="op">=</span> RandomForestClassifier()</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the grid search model</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator <span class="op">=</span> rf, param_grid <span class="op">=</span>param_grid, cv <span class="op">=</span> <span class="dv">3</span>, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, verbose <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>grid_search.fit(x_train_rf, y_train)</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>grid_search.best_params_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 3 folds for each of 32 candidates, totalling 96 fits</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="124">
<pre><code>{'bootstrap': True, 'max_depth': 110, 'max_features': 3, 'n_estimators': 200}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="64">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>rfc <span class="op">=</span> RandomForestClassifier(bootstrap<span class="op">=</span><span class="va">True</span>,max_depth<span class="op">=</span><span class="dv">80</span>,max_features<span class="op">=</span><span class="dv">3</span>,n_estimators<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>rfc.fit(x_train_rf, y_train)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>rfcpredictions <span class="op">=</span> rfc.predict(x_test_rf)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Training accuracy </span><span class="sc">{</span>accuracy_score(y_train, rfc.predict(x_train_rf))<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Testing set accuracy </span><span class="sc">{</span>accuracy_score(y_test, rfcpredictions )<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, rfcpredictions ))</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, rfcpredictions ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training accuracy 1.0
Testing set accuracy 0.8884239888423989
[[4720  187]
 [ 453  376]]
              precision    recall  f1-score   support

           0       0.91      0.96      0.94      4907
           1       0.67      0.45      0.54       829

    accuracy                           0.89      5736
   macro avg       0.79      0.71      0.74      5736
weighted avg       0.88      0.89      0.88      5736
</code></pre>
</div>
</div>
<p>We are getting best performance from Random Forest, so we would also use cross validation to make our model more credible.</p>
<div class="cell" data-execution_count="65">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from sklearn.model_selection import cross_val_score</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co"># scores = cross_val_score(rfc, x_train_rf, y_train, cv=5)</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print(scores)</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co"># K-Fold Cross-Validation</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cross_validation(model, _X, _y, _cv<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>      <span class="co">'''Function to perform 5 Folds Cross-Validation</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co">       Parameters</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="co">       ----------</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="co">      model: Python Class, default=None</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="co">              This is the machine learning algorithm to be used for training.</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="co">      _X: array</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="co">           This is the matrix of features.</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="co">      _y: array</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="co">           This is the target variable.</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="co">      _cv: int, default=5</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a><span class="co">          Determines the number of folds for cross-validation.</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a><span class="co">       Returns</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a><span class="co">       -------</span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a><span class="co">       The function returns a dictionary containing the metrics 'accuracy', 'precision',</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a><span class="co">       'recall', 'f1' for both training set and validation set.</span></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a><span class="co">      '''</span></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>      _scoring <span class="op">=</span> [<span class="st">'accuracy'</span>, <span class="st">'precision'</span>, <span class="st">'recall'</span>, <span class="st">'f1'</span>]</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>      results <span class="op">=</span> cross_validate(estimator<span class="op">=</span>model,</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>                               X<span class="op">=</span>_X,</span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>                               y<span class="op">=</span>_y,</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>                               cv<span class="op">=</span>_cv,</span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>                               scoring<span class="op">=</span>_scoring,</span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>                               return_train_score<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> {<span class="st">"Training Accuracy scores"</span>: results[<span class="st">'train_accuracy'</span>],</span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Mean Training Accuracy"</span>: results[<span class="st">'train_accuracy'</span>].mean()<span class="op">*</span><span class="dv">100</span>,</span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Training Precision scores"</span>: results[<span class="st">'train_precision'</span>],</span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Mean Training Precision"</span>: results[<span class="st">'train_precision'</span>].mean(),</span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Training Recall scores"</span>: results[<span class="st">'train_recall'</span>],</span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Mean Training Recall"</span>: results[<span class="st">'train_recall'</span>].mean(),</span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Training F1 scores"</span>: results[<span class="st">'train_f1'</span>],</span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Mean Training F1 Score"</span>: results[<span class="st">'train_f1'</span>].mean(),</span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Validation Accuracy scores"</span>: results[<span class="st">'test_accuracy'</span>],</span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Mean Validation Accuracy"</span>: results[<span class="st">'test_accuracy'</span>].mean()<span class="op">*</span><span class="dv">100</span>,</span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Validation Precision scores"</span>: results[<span class="st">'test_precision'</span>],</span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Mean Validation Precision"</span>: results[<span class="st">'test_precision'</span>].mean(),</span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Validation Recall scores"</span>: results[<span class="st">'test_recall'</span>],</span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Mean Validation Recall"</span>: results[<span class="st">'test_recall'</span>].mean(),</span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Validation F1 scores"</span>: results[<span class="st">'test_f1'</span>],</span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Mean Validation F1 Score"</span>: results[<span class="st">'test_f1'</span>].mean()</span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a>cross_validation(rfc, x_train_rf, y_train, _cv<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="126">
<pre><code>{'Training Accuracy scores': array([1., 1., 1., 1., 1.]),
 'Mean Training Accuracy': 100.0,
 'Training Precision scores': array([1., 1., 1., 1., 1.]),
 'Mean Training Precision': 1.0,
 'Training Recall scores': array([1., 1., 1., 1., 1.]),
 'Mean Training Recall': 1.0,
 'Training F1 scores': array([1., 1., 1., 1., 1.]),
 'Mean Training F1 Score': 1.0,
 'Validation Accuracy scores': array([0.88254522, 0.88298104, 0.89039006, 0.8858139 , 0.89123801]),
 'Mean Validation Accuracy': 88.65936473311052,
 'Validation Precision scores': array([0.63282937, 0.65291262, 0.68181818, 0.65688488, 0.6745182 ]),
 'Mean Validation Precision': 0.6597926507917622,
 'Validation Recall scores': array([0.44259819, 0.40573152, 0.45248869, 0.43891403, 0.47583082]),
 'Mean Validation Recall': 0.4431126482663714,
 'Validation F1 scores': array([0.52088889, 0.50046512, 0.54397099, 0.52622061, 0.55801594]),
 'Mean Validation F1 Score': 0.5299123103045592}</code></pre>
</div>
</div>
<p>After applying cross validation, we are getting some what real estimates.</p>
<p>AUC Curve : <a href="#fig-roc-curve">Figure&nbsp;1</a><br>
Precision Recall Curve : <a href="#fig-pr-curve">Figure&nbsp;2</a></p>
</section>
</section>
<section id="linear-svc" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Linear SVC</h1>
<p>Finding a linear hyperplane that tries to separate two classes.</p>
<div class="cell" data-execution_count="66">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>svc_linear <span class="op">=</span> LinearSVC(C<span class="op">=</span><span class="fl">1.0</span>, class_weight<span class="op">=</span><span class="va">None</span>, dual<span class="op">=</span><span class="va">True</span>, fit_intercept<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>          intercept_scaling<span class="op">=</span><span class="dv">1</span>, loss<span class="op">=</span><span class="st">'squared_hinge'</span>, max_iter<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>          multi_class<span class="op">=</span><span class="st">'ovr'</span>, penalty<span class="op">=</span><span class="st">'l2'</span>, random_state<span class="op">=</span><span class="dv">123</span>, tol<span class="op">=</span><span class="fl">0.0001</span>,</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>          verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>svc_linear.fit(x_train,y_train)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>svc_linear_predictions <span class="op">=</span> svc_linear.predict(x_test)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(accuracy_score(y_test, svc_linear_predictions))</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, svc_linear_predictions))</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, svc_linear_predictions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.8559972105997211
[[4898    9]
 [ 817   12]]
              precision    recall  f1-score   support

           0       0.86      1.00      0.92      4907
           1       0.57      0.01      0.03       829

    accuracy                           0.86      5736
   macro avg       0.71      0.51      0.48      5736
weighted avg       0.82      0.86      0.79      5736
</code></pre>
</div>
</div>
</section>
<section id="svc" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> SVC</h1>
<p>Finding a complex hyperplane that tries to separate the classes.</p>
<div class="cell" data-execution_count="67">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  SVM - Support Vector Machines balance check on unbalance test</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>svc<span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">'poly'</span>, random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>svc.fit(x_train,y_train)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>svcpredictions <span class="op">=</span> svc.predict(x_test)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(accuracy_score(y_test, svcpredictions))</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, svcpredictions))</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, svcpredictions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.8554741980474198
[[4907    0]
 [ 829    0]]
              precision    recall  f1-score   support

           0       0.86      1.00      0.92      4907
           1       0.00      0.00      0.00       829

    accuracy                           0.86      5736
   macro avg       0.43      0.50      0.46      5736
weighted avg       0.73      0.86      0.79      5736
</code></pre>
</div>
</div>
</section>
<section id="naive-bayes" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Naive Bayes</h1>
<p>Naive Bayes a naive assumption that all the features are independent of each other and thus by reducing the complexity of computing conditional probabilities it evaluates the probability of 0 and 1.</p>
<div class="cell" data-execution_count="68">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>param_grid_nb <span class="op">=</span> {</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'var_smoothing'</span>: np.logspace(<span class="dv">0</span>,<span class="op">-</span><span class="dv">9</span>, num<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>nbModel_grid <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>GaussianNB(), param_grid<span class="op">=</span>param_grid_nb, verbose<span class="op">=</span><span class="dv">1</span>, cv<span class="op">=</span><span class="dv">10</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>nbModel_grid.fit(x_train, y_train)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nbModel_grid.best_estimator_)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>modelNB <span class="op">=</span> GaussianNB(var_smoothing<span class="op">=</span><span class="fl">0.04328761281083057</span>)</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>modelNB.fit(x_train,y_train)</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Model score is </span><span class="sc">{</span>modelNB<span class="sc">.</span>score(x_test,y_test)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modelProbability(prediction0,prediction1,y):</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">7</span>))</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>    plt.hist(prediction1[y<span class="op">==</span><span class="dv">0</span>], bins<span class="op">=</span><span class="dv">50</span>, label<span class="op">=</span><span class="st">'No/probability 1'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>    plt.hist(prediction0[y<span class="op">==</span><span class="dv">0</span>], bins<span class="op">=</span><span class="dv">50</span>, label<span class="op">=</span><span class="st">'No/probability 0'</span>)</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>    plt.hist(prediction0[y<span class="op">==</span><span class="dv">1</span>], bins<span class="op">=</span><span class="dv">50</span>, label<span class="op">=</span><span class="st">'Yes/probability 0'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>    plt.hist(prediction1[y<span class="op">==</span><span class="dv">1</span>], bins<span class="op">=</span><span class="dv">50</span>, label<span class="op">=</span><span class="st">'Yes/probability 1'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Probability of being Positive/Negative Class'</span>, fontsize<span class="op">=</span><span class="dv">25</span>)</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Number of records in each bucket'</span>, fontsize<span class="op">=</span><span class="dv">25</span>)</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>    plt.legend(fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>    plt.tick_params(axis<span class="op">=</span><span class="st">'both'</span>, labelsize<span class="op">=</span><span class="dv">25</span>, pad<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>    plt.show() </span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>pred1<span class="op">=</span>modelNB.predict_proba(x_test)[:,<span class="dv">0</span>]</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>pred2 <span class="op">=</span> modelNB.predict_proba(x_test)[:,<span class="dv">1</span>]</span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>modelProbability(pred1,pred2,y_test)</span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a><span class="co">#modelling</span></span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modelEvaluation(model,x,y):</span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'test set evaluation: '</span>)</span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model.predict(x)</span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(accuracy_score(y, y_pred))</span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(confusion_matrix(y, y_pred))</span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(classification_report(y, y_pred))</span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a>modelEvaluation(modelNB,x_test,y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 10 folds for each of 100 candidates, totalling 1000 fits</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>GaussianNB(var_smoothing=0.0657933224657568)
Model score is 0.8561715481171548</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-69-output-3.png" width="1260" height="620"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>test set evaluation: 
0.8561715481171548
[[4892   15]
 [ 810   19]]
              precision    recall  f1-score   support

           0       0.86      1.00      0.92      4907
           1       0.56      0.02      0.04       829

    accuracy                           0.86      5736
   macro avg       0.71      0.51      0.48      5736
weighted avg       0.81      0.86      0.80      5736
</code></pre>
</div>
</div>
<section id="for-balanced" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="for-balanced"><span class="header-section-number">16.1</span> For balanced</h2>
<p>For balanced dataset, as we can see there is a slight improvement in performance. The f1 score has improved and also, the yellow bars are now slightly shifted towards right side.</p>
<div class="cell" data-execution_count="69">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>param_grid_nb <span class="op">=</span> {</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'var_smoothing'</span>: np.logspace(<span class="dv">0</span>,<span class="op">-</span><span class="dv">9</span>, num<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>modelNB <span class="op">=</span> GaussianNB(var_smoothing<span class="op">=</span><span class="fl">0.04328761281083057</span>)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>modelNB.fit(bx_train,by_train)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Model score is </span><span class="sc">{</span>modelNB<span class="sc">.</span>score(x_test,y_test)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modelProbability(prediction0,prediction1,y):</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">7</span>))</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>    plt.hist(prediction1[y<span class="op">==</span><span class="dv">0</span>], bins<span class="op">=</span><span class="dv">50</span>, label<span class="op">=</span><span class="st">'No/probability 1'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>    plt.hist(prediction0[y<span class="op">==</span><span class="dv">0</span>], bins<span class="op">=</span><span class="dv">50</span>, label<span class="op">=</span><span class="st">'No/probability 0'</span>)</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>    plt.hist(prediction0[y<span class="op">==</span><span class="dv">1</span>], bins<span class="op">=</span><span class="dv">50</span>, label<span class="op">=</span><span class="st">'Yes/probability 0'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>    plt.hist(prediction1[y<span class="op">==</span><span class="dv">1</span>], bins<span class="op">=</span><span class="dv">50</span>, label<span class="op">=</span><span class="st">'Yes/probability 1'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Probability of being Positive/Negative Class'</span>, fontsize<span class="op">=</span><span class="dv">25</span>)</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Number of records in each bucket'</span>, fontsize<span class="op">=</span><span class="dv">25</span>)</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>    plt.legend(fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>    plt.tick_params(axis<span class="op">=</span><span class="st">'both'</span>, labelsize<span class="op">=</span><span class="dv">25</span>, pad<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>    plt.show() </span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>pred1<span class="op">=</span>modelNB.predict_proba(x_test)[:,<span class="dv">0</span>]</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>pred2 <span class="op">=</span> modelNB.predict_proba(x_test)[:,<span class="dv">1</span>]</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>modelProbability(pred1,pred2,y_test)</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a><span class="co">#modelling</span></span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modelEvaluation(model,x,y):</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'test set evaluation: '</span>)</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model.predict(x)</span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(accuracy_score(y, y_pred))</span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(confusion_matrix(y, y_pred))</span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(classification_report(y, y_pred))</span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a>modelEvaluation(modelNB,x_test,y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model score is 0.693863319386332</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-70-output-2.png" width="1260" height="620"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>test set evaluation: 
0.693863319386332
[[3690 1217]
 [ 539  290]]
              precision    recall  f1-score   support

           0       0.87      0.75      0.81      4907
           1       0.19      0.35      0.25       829

    accuracy                           0.69      5736
   macro avg       0.53      0.55      0.53      5736
weighted avg       0.77      0.69      0.73      5736
</code></pre>
</div>
</div>
<p>As we can see from the graph for the red and yellow bars for yes(1 term deposit) are coming on the opposite sides which is not expected.</p>
<p>AUC Curve : <a href="#fig-roc-curve">Figure&nbsp;1</a><br>
Precision Recall Curve : <a href="#fig-pr-curve">Figure&nbsp;2</a></p>
</section>
</section>
<section id="knn" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> KNN</h1>
<p>Using the k - nearest neighbours we try to predict the testing dataset. Now to find the optimal k value we will look into precision and accuracy curve for different k values.</p>
<div class="cell" data-execution_count="70">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>acc <span class="op">=</span> []</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>prec <span class="op">=</span> []</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Will take some time</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">40</span>):</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    neigh <span class="op">=</span> KNeighborsClassifier(n_neighbors <span class="op">=</span> i).fit(x_train,y_train)</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> neigh.predict(x_test)</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>    acc.append(metrics.accuracy_score(y_test, y_pred))</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>    prec.append((metrics.average_precision_score(y_test, y_pred)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="71">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">40</span>),acc,color <span class="op">=</span> <span class="st">'blue'</span>,linestyle<span class="op">=</span><span class="st">'dashed'</span>, </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>         marker<span class="op">=</span><span class="st">'o'</span>,markerfacecolor<span class="op">=</span><span class="st">'red'</span>,  markersize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'accuracy vs. K Value'</span>)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'K'</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Accuracy'</span>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Maximum accuracy:-"</span>,<span class="bu">max</span>(acc),<span class="st">"at K ="</span>,acc.index(<span class="bu">max</span>(acc)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Maximum accuracy:- 0.8769177126917713 at K = 19</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-72-output-2.png" width="833" height="529" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Accuracy curve for different k values</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="72">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.figure(figsize=(10,6))</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">40</span>),prec,color <span class="op">=</span> <span class="st">'blue'</span>,linestyle<span class="op">=</span><span class="st">'dashed'</span>, </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>         marker<span class="op">=</span><span class="st">'o'</span>,markerfacecolor<span class="op">=</span><span class="st">'red'</span>, markersize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'precision vs. K Value'</span>)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'K'</span>)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Precision'</span>)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Maximum Precision:-"</span>,<span class="bu">max</span>(prec),<span class="st">"at K ="</span>,prec.index(<span class="bu">max</span>(prec)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Maximum Precision:- 0.32247407633937064 at K = 8</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Team11_CodeAndTechnical_files/figure-html/cell-73-output-2.png" width="601" height="455" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Precision curve for different k values</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Based on the above plot, optimal k value is 3, with maximum f1 score of 0.64.</p>
<div class="cell" data-execution_count="73">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>mrroger <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>knn <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span>mrroger) <span class="co"># instantiate with n value given</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>knn.fit(x_train,y_train)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> knn.predict(x_test)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="co">#y_pred = knn.predict_proba(x_test)</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Train set accuracy </span><span class="sc">{</span>accuracy_score(y_train, knn.predict(x_train))<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Test set accuracy </span><span class="sc">{</span>accuracy_score(y_test, y_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Train set accuracy 0.9197611576011158
Test set accuracy 0.8657601115760112
[[4626  281]
 [ 489  340]]
              precision    recall  f1-score   support

           0       0.90      0.94      0.92      4907
           1       0.55      0.41      0.47       829

    accuracy                           0.87      5736
   macro avg       0.73      0.68      0.70      5736
weighted avg       0.85      0.87      0.86      5736
</code></pre>
</div>
</div>
<p>AUC Curve : <a href="#fig-roc-curve">Figure&nbsp;1</a><br>
Precision Recall Curve : <a href="#fig-pr-curve">Figure&nbsp;2</a></p>
</section>
<section id="roc--auc-curve" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> ROC -AUC Curve</h1>
<div class="cell" data-execution_count="74">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_auc_score, roc_curve</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the classfiers and make a list</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>classifiers <span class="op">=</span> [LogisticRegression(random_state<span class="op">=</span><span class="dv">123</span>),</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>        DecisionTreeClassifier(criterion<span class="op">=</span><span class="st">'entropy'</span>,max_depth<span class="op">=</span><span class="dv">8</span>,max_features<span class="op">=</span> <span class="fl">0.8</span>,splitter<span class="op">=</span><span class="st">'best'</span>),</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>        RandomForestClassifier(bootstrap<span class="op">=</span><span class="va">True</span>,max_depth<span class="op">=</span><span class="dv">80</span>,max_features<span class="op">=</span><span class="dv">3</span>,n_estimators<span class="op">=</span><span class="dv">200</span>),</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">#SVC(kernel='poly', random_state=123),</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>        GaussianNB(var_smoothing<span class="op">=</span><span class="fl">0.04328761281083057</span>),</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>        KNeighborsClassifier(n_neighbors<span class="op">=</span>mrroger)]</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a result table as a DataFrame</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>result_table <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">'classifiers'</span>, <span class="st">'fpr'</span>,<span class="st">'tpr'</span>,<span class="st">'auc'</span>])</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> x_train</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> x_test</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the models and record the results</span></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cls <span class="kw">in</span> classifiers:</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> cls.fit(X_train, y_train)</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>    yproba <span class="op">=</span> model.predict_proba(X_test)[::,<span class="dv">1</span>]</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>    fpr, tpr, _ <span class="op">=</span> roc_curve(y_test,  yproba)</span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>    auc <span class="op">=</span> roc_auc_score(y_test, yproba)</span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>    result_table <span class="op">=</span> result_table.append({<span class="st">'classifiers'</span>:cls.__class__.<span class="va">__name__</span>,</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">'fpr'</span>:fpr, </span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">'tpr'</span>:tpr, </span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">'auc'</span>:auc}, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Set name of the classifiers as index labels</span></span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a>result_table.set_index(<span class="st">'classifiers'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> result_table.index:</span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a>    plt.plot(result_table.loc[i][<span class="st">'fpr'</span>], </span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a>             result_table.loc[i][<span class="st">'tpr'</span>], </span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a>             label<span class="op">=</span><span class="st">"</span><span class="sc">{}</span><span class="st">, AUC=</span><span class="sc">{:.3f}</span><span class="st">"</span>.<span class="bu">format</span>(i, result_table.loc[i][<span class="st">'auc'</span>]))</span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb119-38"><a href="#cb119-38" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>,<span class="dv">1</span>], [<span class="dv">0</span>,<span class="dv">1</span>], color<span class="op">=</span><span class="st">'orange'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb119-39"><a href="#cb119-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-40"><a href="#cb119-40" aria-hidden="true" tabindex="-1"></a>plt.xticks(np.arange(<span class="fl">0.0</span>, <span class="fl">1.1</span>, step<span class="op">=</span><span class="fl">0.1</span>))</span>
<span id="cb119-41"><a href="#cb119-41" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Flase Positive Rate"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb119-42"><a href="#cb119-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-43"><a href="#cb119-43" aria-hidden="true" tabindex="-1"></a>plt.yticks(np.arange(<span class="fl">0.0</span>, <span class="fl">1.1</span>, step<span class="op">=</span><span class="fl">0.1</span>))</span>
<span id="cb119-44"><a href="#cb119-44" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"True Positive Rate"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb119-45"><a href="#cb119-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-46"><a href="#cb119-46" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'ROC Curve Analysis'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb119-47"><a href="#cb119-47" aria-hidden="true" tabindex="-1"></a>plt.legend(prop<span class="op">=</span>{<span class="st">'size'</span>:<span class="dv">13</span>}, loc<span class="op">=</span><span class="st">'lower right'</span>)</span>
<span id="cb119-48"><a href="#cb119-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-49"><a href="#cb119-49" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-roc-curve" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Team11_CodeAndTechnical_files/figure-html/fig-roc-curve-output-1.png" width="671" height="535" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: AUC ROC Curve for all Models</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="precision-recall-curve" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Precision Recall Curve</h1>
<p>In imbalance problem since we have a high number of Negatives, this makes the False Posiitve Rate as low, resulting in the shift of ROC AUC Curve towards left, which is slightly misleading.</p>
<p>So in imbalance problem we usually make sure to look at precision recall curve as well.</p>
<div class="cell" data-execution_count="75">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Logistic Regression</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>lr_probs <span class="op">=</span> lr.predict_proba(X_test_final)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>lr_probs <span class="op">=</span> lr_probs[:, <span class="dv">1</span>]</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> lr.predict(X_test_final)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>lr_precision, lr_recall, _ <span class="op">=</span> precision_recall_curve(y_test, lr_probs)</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>no_skill <span class="op">=</span> <span class="bu">len</span>(y_test[y_test<span class="op">==</span><span class="dv">1</span>]) <span class="op">/</span> <span class="bu">len</span>(y_test)</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>pyplot.plot([<span class="dv">0</span>, <span class="dv">1</span>], [no_skill, no_skill], linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'No Skill'</span>)</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>pyplot.plot(lr_recall, lr_precision, marker<span class="op">=</span><span class="st">'.'</span>, label<span class="op">=</span><span class="st">'Logistic'</span>)</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="co"># axis labels</span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Decision Tree Classifier</span></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>dtc_probs <span class="op">=</span> dtc.predict_proba(x_test_dt)</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>dtc_probs <span class="op">=</span> dtc_probs[:, <span class="dv">1</span>]</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> dtc.predict(x_test_dt)</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>dtc_precision, dtc_recall, _ <span class="op">=</span> precision_recall_curve(y_test, dtc_probs)</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>no_skill <span class="op">=</span> <span class="bu">len</span>(y_test[y_test<span class="op">==</span><span class="dv">1</span>]) <span class="op">/</span> <span class="bu">len</span>(y_test)</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>pyplot.plot(dtc_recall, dtc_precision, marker<span class="op">=</span><span class="st">'.'</span>, label<span class="op">=</span><span class="st">'Decision Tree'</span>)</span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Random Forest Classifier</span></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>rfc_probs <span class="op">=</span> rfc.predict_proba(x_test_rf)</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>rfc_probs <span class="op">=</span> rfc_probs[:, <span class="dv">1</span>]</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> rfc.predict(x_test_rf)</span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>rfc_precision, rfc_recall, _ <span class="op">=</span> precision_recall_curve(y_test, rfc_probs)</span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>no_skill <span class="op">=</span> <span class="bu">len</span>(y_test[y_test<span class="op">==</span><span class="dv">1</span>]) <span class="op">/</span> <span class="bu">len</span>(y_test)</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>pyplot.plot(rfc_recall, rfc_precision, marker<span class="op">=</span><span class="st">'.'</span>, label<span class="op">=</span><span class="st">'Random Forest'</span>)</span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Gaussian Model</span></span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a>nb_probs <span class="op">=</span> modelNB.predict_proba(x_test)</span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a><span class="co"># keep probabilities for the positive outcome only</span></span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a>nb_probs <span class="op">=</span> nb_probs[:, <span class="dv">1</span>]</span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a><span class="co"># predict class values</span></span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> modelNB.predict(x_test)</span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a>nb_precision, nb_recall, _ <span class="op">=</span> precision_recall_curve(y_test, nb_probs)</span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a>no_skill <span class="op">=</span> <span class="bu">len</span>(y_test[y_test<span class="op">==</span><span class="dv">1</span>]) <span class="op">/</span> <span class="bu">len</span>(y_test)</span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a>pyplot.plot(nb_recall, nb_precision, marker<span class="op">=</span><span class="st">'.'</span>, label<span class="op">=</span><span class="st">'Naive Bayes'</span>)</span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a><span class="co">#knn</span></span>
<span id="cb120-38"><a href="#cb120-38" aria-hidden="true" tabindex="-1"></a>knn_probs <span class="op">=</span> knn.predict_proba(x_test)</span>
<span id="cb120-39"><a href="#cb120-39" aria-hidden="true" tabindex="-1"></a>knn_probs <span class="op">=</span> knn_probs[:, <span class="dv">1</span>]</span>
<span id="cb120-40"><a href="#cb120-40" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> knn.predict(x_test)</span>
<span id="cb120-41"><a href="#cb120-41" aria-hidden="true" tabindex="-1"></a>knn_precision, knn_recall, _ <span class="op">=</span> precision_recall_curve(y_test, knn_probs)</span>
<span id="cb120-42"><a href="#cb120-42" aria-hidden="true" tabindex="-1"></a>no_skill <span class="op">=</span> <span class="bu">len</span>(y_test[y_test<span class="op">==</span><span class="dv">1</span>]) <span class="op">/</span> <span class="bu">len</span>(y_test)</span>
<span id="cb120-43"><a href="#cb120-43" aria-hidden="true" tabindex="-1"></a>pyplot.plot(knn_recall, knn_precision, marker<span class="op">=</span><span class="st">'.'</span>, label<span class="op">=</span><span class="st">'KNN'</span>)</span>
<span id="cb120-44"><a href="#cb120-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-45"><a href="#cb120-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-46"><a href="#cb120-46" aria-hidden="true" tabindex="-1"></a>pyplot.xlabel(<span class="st">'Recall'</span>)</span>
<span id="cb120-47"><a href="#cb120-47" aria-hidden="true" tabindex="-1"></a>pyplot.ylabel(<span class="st">'Precision'</span>)</span>
<span id="cb120-48"><a href="#cb120-48" aria-hidden="true" tabindex="-1"></a><span class="co"># show the legend</span></span>
<span id="cb120-49"><a href="#cb120-49" aria-hidden="true" tabindex="-1"></a>pyplot.legend()</span>
<span id="cb120-50"><a href="#cb120-50" aria-hidden="true" tabindex="-1"></a><span class="co"># show the plot</span></span>
<span id="cb120-51"><a href="#cb120-51" aria-hidden="true" tabindex="-1"></a>pyplot.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-pr-curve" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Team11_CodeAndTechnical_files/figure-html/fig-pr-curve-output-1.png" width="593" height="435" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Precision Recall Curve for all Models</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>As per the ROC Curve and Precision Recall curve, KNN is performing best. But after combining these results with precision recall curve, we suggest using Random Forest for our problem.</p>
</section>
<section id="summary-1" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Summary</h1>
<div id="tbl-letters" class="anchored">
<table class="table">
<caption>Table&nbsp;1: Summary of Models</caption>
<thead>
<tr class="header">
<th>Model</th>
<th>Accuracy</th>
<th>Precision</th>
<th>Recall</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Logistic(Cutoff=0.25)</td>
<td>0.88</td>
<td>0.51</td>
<td>0.58</td>
<td>0.872</td>
</tr>
<tr class="even">
<td>Logistic (Balanced-Train)</td>
<td>0.85</td>
<td>0.49</td>
<td>0.54</td>
<td></td>
</tr>
<tr class="odd">
<td>Decision Tree</td>
<td>0.91</td>
<td>0.66</td>
<td>0.47</td>
<td>0.923</td>
</tr>
<tr class="even">
<td>Random Forest</td>
<td>0.88</td>
<td>0.66</td>
<td>0.46</td>
<td>0.913</td>
</tr>
<tr class="odd">
<td>SVC</td>
<td>0.89</td>
<td>0.75</td>
<td>0.15</td>
<td></td>
</tr>
<tr class="even">
<td>Linear SVC</td>
<td>0.89</td>
<td>0.62</td>
<td>0.16</td>
<td></td>
</tr>
<tr class="odd">
<td>Gaussian Bayes</td>
<td>0.88</td>
<td>0.50</td>
<td>0.25</td>
<td>0.841</td>
</tr>
<tr class="even">
<td>KNN</td>
<td>0.92</td>
<td>0.78</td>
<td>0.54</td>
<td>0.965</td>
</tr>
<tr class="odd">
<td>Naive Bayes</td>
<td>0.85</td>
<td>0.56</td>
<td>0.02</td>
<td></td>
</tr>
<tr class="even">
<td>Naive Bayes (Balanced-Train)</td>
<td>0.69</td>
<td>0.19</td>
<td>0.35</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>See <a href="#tbl-letters">Table&nbsp;1</a>.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



<script src="Team11_CodeAndTechnical_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>